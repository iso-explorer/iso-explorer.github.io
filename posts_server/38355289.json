post_cb({"38355718": {"Id": "38355718", "PostTypeId": "2", "Body": "<p>This is undefined behavior according to the standard.</p>\n<p><a href=\"http://eel.is/c++draft/cpp.cond#8\">[cpp.cond]</a>, emphasis mine</p>\n<blockquote>\n<p id=\"so_38355289_38355718_0\">Prior to evaluation, macro invocations in the list of preprocessing tokens that will become the controlling constant expression are replaced (except for those macro names modified by the <code>defined</code> unary operator), just as in normal text. <strong>If the token <code>defined</code> is generated as a result of this replacement process</strong> or use of the <code>defined</code> unary operator does not match one of the two specified forms prior to macro replacement, <strong>the behavior is undefined</strong>.</p>\n</blockquote>\n", "LastActivityDate": "2016-07-13T15:18:33.030", "CommentCount": "0", "CreationDate": "2016-07-13T15:18:33.030", "ParentId": "38355289", "Score": "7", "OwnerUserId": "4672588"}, "38355289": {"ViewCount": "87", "Body": "<p>Running the following code</p>\n<pre><code>#include &lt;iostream&gt;\n\n#define FOO\n#define BAR defined(FOO)\n\nint main() {\n#if BAR\n    std::cout &lt;&lt; \"BAR enabled!\" &lt;&lt; std::endl;\n#else\n    std::cout &lt;&lt; \"BAR disabled!\" &lt;&lt; std::endl;\n#endif\n    return 0;\n}\n</code></pre>\n<p>in <a href=\"http://rextester.com/CJR20765\">Visual Studio</a> displays <code>Bar disabled!</code>, while running the same code in <a href=\"http://rextester.com/UGB49419\">gcc</a> or <a href=\"http://rextester.com/PSZH59857\">clang</a> displays <code>Bar enabled!</code>.</p>\n<p><strong>Is this a bug in the Microsoft compiler? What is correct according to the standard?</strong></p>\n", "AcceptedAnswerId": "38355718", "Title": "defined(VARIABLE) not evaluated correctly by MSVC?", "CreationDate": "2016-07-13T15:00:03.903", "Id": "38355289", "CommentCount": "0", "FavoriteCount": "0", "PostTypeId": "1", "LastActivityDate": "2016-07-13T15:18:33.030", "Score": "6", "OwnerUserId": "369009", "Tags": "<c++><gcc><visual-c++><visual-studio-2015><clang>", "AnswerCount": "1"}, "bq_ids": {"n4140": {"so_38355289_38355718_0": {"length": 45, "quality": 1.0, "section_id": 500}}, "n3337": {"so_38355289_38355718_0": {"length": 45, "quality": 1.0, "section_id": 491}}, "n4659": {"so_38355289_38355718_0": {"length": 45, "quality": 1.0, "section_id": 519}}}});