post_cb({"31493296": {"ViewCount": "398", "Body": "<p>Consider this (minimized) example:</p>\n<pre><code>template &lt;typename Descriptor&gt;\nclass hash_table\n{\npublic:\n  typedef int value_type;\n\n  template &lt;typename Argument, int Callback (value_type *, Argument)&gt;\n  void traverse (Argument);\n\n  template &lt;int Callback (value_type *)&gt;\n  void traverse_void ();\n};\n</code></pre>\n<p>I defined a class template which has template member functions with non-type parameters. Note that <code>Callback</code> depends on <code>value_type</code> typedef. Now I want to define the functions themselves:</p>\n<pre><code>template &lt;typename Descriptor&gt;\ntemplate &lt;typename Argument, int Callback (typename hash_table &lt;Descriptor&gt;::value_type *, Argument)&gt;\nvoid hash_table &lt;Descriptor&gt;::traverse (Argument) {}\n\ntemplate &lt;typename Descriptor&gt;\ntemplate &lt;int Callback (typename hash_table &lt;Descriptor&gt;::value_type *)&gt;\nvoid hash_table &lt;Descriptor&gt;::traverse_void () {}\n</code></pre>\n<p>I get inconsistent errors from the compilers. The result does not depend on options, specifying the version of C++ standard (i.e., same for C++98, C++11 and C++14), but depends on the compiler.</p>\n<p>GCC 6.0.0 (recent trunk, as well as several other versions) accepts this code.</p>\n<p>Clang 3.7.0 (recent trunk) gives the following error:</p>\n<pre><code>test.cc:18:31: error: out-of-line definition of 'traverse_void' does not match any declaration in 'hash_table&lt;Descriptor&gt;'\nvoid hash_table &lt;Descriptor&gt;::traverse_void() {}\n                              ^~~~~~~~~~~~~\n1 error generated.\n</code></pre>\n<p>EDG (Intel C++ Compiler v. 15.0.3) gives two errors:</p>\n<pre><code>test.cc(15): error: declaration is incompatible with function template \"void hash_table&lt;Descriptor&gt;::traverse&lt;Argument,Callback&gt;(Argument)\" (declared at line 7)\n  void hash_table &lt;Descriptor&gt;::traverse (Argument) {}\n                                ^\n\ntest.cc(19): error: declaration is incompatible with function template \"void hash_table&lt;Descriptor&gt;::traverse_void&lt;Callback&gt;()\" (declared at line 10)\n  void hash_table &lt;Descriptor&gt;::traverse_void () {}\n                                ^\ncompilation aborted for test.cc (code 2)\n</code></pre>\n<p>What is the expected behavior (according to the standard)? If the code is wrong, how do I fix the function definitions?</p>\n", "AcceptedAnswerId": "31493775", "Title": "Defining out-of-line member template functions", "CreationDate": "2015-07-18T16:36:33.300", "Id": "31493296", "CommentCount": "0", "LastEditDate": "2015-07-18T17:44:52.113", "PostTypeId": "1", "LastEditorUserId": "2069064", "LastActivityDate": "2015-07-18T18:10:12.573", "Score": "7", "OwnerUserId": "4142343", "Tags": "<c++><templates><language-lawyer><member-functions>", "AnswerCount": "1"}, "bq_ids": {"n4140": {"so_31493296_31493775_0": {"length": 13, "quality": 1.0, "section_id": 61}}, "n3337": {"so_31493296_31493775_0": {"length": 13, "quality": 1.0, "section_id": 56}}, "n4659": {"so_31493296_31493775_0": {"length": 8, "quality": 0.6153846153846154, "section_id": 63}}}, "31493775": {"Id": "31493775", "PostTypeId": "2", "Body": "<p>Your code looks fine to me, I see no reason for it to not compile. Probably a bug on the compilers that disallow it. However, since [temp.param]:</p>\n<blockquote>\n<p id=\"so_31493296_31493775_0\">A non-type <em>template-parameter</em> of type \u201carray of <code>T</code>\u201d or \u201cfunction returning <code>T</code>\u201d is adjusted to be of type\n  \u201cpointer to <code>T</code>\u201d or \u201cpointer to function returning <code>T</code>\u201d, respectively.</p>\n</blockquote>\n<p>You could simply switch <code>Callback</code> yourself to be a pointer-to-function. The behavior would be identical in all respects, with the added benefit that this code also compiles on clang. </p>\n", "LastEditorUserId": "2069064", "LastActivityDate": "2015-07-18T18:10:12.573", "Score": "1", "CreationDate": "2015-07-18T17:39:52.780", "ParentId": "31493296", "CommentCount": "2", "OwnerUserId": "2069064", "LastEditDate": "2015-07-18T18:10:12.573"}});