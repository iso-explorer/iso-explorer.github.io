post_cb({"47765952": {"ViewCount": "90", "Body": "<p>I have 2 classes A and B. B is derived from A. A has a function pointer member, for which the argument is an object of B. The classes are defined as follows:</p>\n<pre><code>class B;\ntypedef double (*func_ptr)(B *);\n\nclass A\n{\n  private:\n    func_ptr func;\n};\n\nclass B: public A\n{\n  private:\n    double C;\n};\n</code></pre>\n<p>When I try to dynamic cast a void* into A* or B*, I get the following error:</p>\n<pre><code>void *v_ptr;\nA *a_ptr = dynamic_cast&lt;A*&gt;(v_ptr);\nB *b_ptr = dynamic_cast&lt;B*&gt;(v_ptr);\n\nerror: the operand of a pointer dynamic_cast must be a pointer to a complete class type\n</code></pre>\n<p>I have no clue why this is happening. There are no virtual methods in either of the classes. I know that forward declaration of a class cannot be used to declare members, but here it's being used to define a pointer.</p>\n<p>Can anyone explain why I'm getting this error?</p>\n", "Title": "Incomplete class: Convert void* to pointer to class type via dynamic_cast", "CreationDate": "2017-12-12T05:36:12.180", "LastActivityDate": "2017-12-12T05:54:57.803", "CommentCount": "3", "LastEditDate": "2017-12-12T05:54:53.647", "PostTypeId": "1", "LastEditorUserId": "3309790", "Id": "47765952", "Score": "1", "OwnerUserId": "3704409", "Tags": "<c++><casting><forward-declaration><dynamic-cast><incomplete-type>", "AnswerCount": "2"}, "bq_ids": {"n4140": {"so_47765952_47766014_1": {"length": 9, "quality": 0.75, "section_id": 4706}, "so_47765952_47766017_0": {"length": 11, "quality": 0.6111111111111112, "section_id": 4706}, "so_47765952_47766014_0": {"length": 7, "quality": 0.5384615384615384, "section_id": 43}}, "n3337": {"so_47765952_47766014_0": {"length": 7, "quality": 0.5384615384615384, "section_id": 40}, "so_47765952_47766017_0": {"length": 11, "quality": 0.6111111111111112, "section_id": 5779}, "so_47765952_47766014_1": {"length": 8, "quality": 0.6666666666666666, "section_id": 4515}}, "n4659": {"so_47765952_47766014_0": {"length": 8, "quality": 0.6153846153846154, "section_id": 7504}, "so_47765952_47766017_0": {"length": 11, "quality": 0.6111111111111112, "section_id": 6103}, "so_47765952_47766014_1": {"length": 8, "quality": 0.6666666666666666, "section_id": 7511}}}, "47766017": {"Id": "47766017", "PostTypeId": "2", "Body": "<p>The operand of <code>dynamic_cast</code>must be a pointer to a complete class type (<a href=\"https://timsong-cpp.github.io/cppwp/n4659/expr.dynamic.cast\" rel=\"nofollow noreferrer\">[expr.dynamic.cast]</a>):</p>\n<blockquote id=\"so_47765952_47766017_0\">\n<ol>\n<li>The result of the expression <code>dynamic_\u00adcast&lt;T&gt;(v)</code> is the result of converting the expression v to type T....</li>\n<li>If T is a pointer type, v shall be a prvalue of a pointer to complete class type, and the result is a prvalue of type T...</li>\n</ol>\n</blockquote>\n<p>Furthermore, it's really unclear <em>why</em> you are using <code>dynamic_cast</code> at all. The classes in your example are not polymorphic. There are no virtual functions in sight.</p>\n", "LastEditorUserId": "817643", "LastActivityDate": "2017-12-12T05:45:45.613", "Score": "1", "CreationDate": "2017-12-12T05:43:01.320", "ParentId": "47765952", "CommentCount": "1", "OwnerUserId": "817643", "LastEditDate": "2017-12-12T05:45:45.613"}, "47766014": {"Id": "47766014", "PostTypeId": "2", "Body": "<p>You can't convert <code>void*</code> by <a href=\"http://en.cppreference.com/w/cpp/language/dynamic_cast\" rel=\"nofollow noreferrer\"><code>dynamic_cast</code></a>, the expression required by <code>dynamic_cast</code> must refer to a complete class type, while <code>void</code> is not.</p>\n<p>(emphasis mine)</p>\n<blockquote>\n<p id=\"so_47765952_47766014_0\">lvalue of a <strong>complete class type</strong> if <code>new_type</code> is a reference, prvalue of a pointer to <strong>complete class type</strong> if <code>new_type</code> is a pointer.</p>\n</blockquote>\n<p>BTW: The converting type should refer to a complete class type too.</p>\n<blockquote>\n<p id=\"so_47765952_47766014_1\">pointer to complete class type, reference to complete class type, or pointer to (optionally cv-qualified) void</p>\n</blockquote>\n", "LastEditorUserId": "3309790", "LastActivityDate": "2017-12-12T05:54:57.803", "Score": "2", "CreationDate": "2017-12-12T05:42:43.647", "ParentId": "47765952", "CommentCount": "1", "OwnerUserId": "3309790", "LastEditDate": "2017-12-12T05:54:57.803"}});