post_cb({"32129263": {"CommentCount": "7", "ViewCount": "76", "PostTypeId": "1", "LastEditorUserId": "298171", "CreationDate": "2015-08-20T22:10:25.023", "LastActivityDate": "2015-08-20T23:25:18.077", "Title": "Specializing inner template of templated class", "AcceptedAnswerId": "32130042", "LastEditDate": "2015-08-20T22:27:55.687", "Id": "32129263", "Score": "0", "Body": "<p>So I have a templated Image class, for which I am trying to set up inline color-conversions. This is a simplification of the code that is vexing me:</p>\n<pre><code>template &lt;typename Color = colors::RGB&gt;\nclass Image {\n\n    /// ...\n\n    template &lt;typename DestColor&gt;\n    operator Image&lt;DestColor&gt;() {\n        /// when assigning with a different colorspace:\n        /// ... do the color conversion\n        /// ... and return a fresh Image&lt;DestColor&gt;\n    }\n\n    template &lt;&gt;\n    operator Image&lt;Color&gt;() {\n        /// when assigning with the same colorspace:\n        return *this;\n    }\n\n};\n</code></pre>\n<p>\u2026 the problem is that the template specialization that follows the templated conversion operator can\u2019t be defined at the class level (according to the errors I am getting).</p>\n<p>I get that one needs to specify the specialization out-of-line, but I can\u2019t for the life of me figure out the syntax. How should I declare that specialization?</p>\n", "Tags": "<c++><templates><inline><template-specialization><partial-specialization>", "OwnerUserId": "298171", "AnswerCount": "1"}, "32130042": {"ParentId": "32129263", "CommentCount": "1", "Body": "<p>Just remove the specialization. Your conversion function will never be called anyway if <code>DestColor</code> is the same as <code>Color</code>. [class.conv.fct]/p1:</p>\n<blockquote>\n<p id=\"so_32129263_32130042_0\">A conversion function is never used to convert a (possibly\n  cv-qualified) object to the (possibly cv-qualified) same object type\n  (or a reference to it), to a (possibly cv-qualified) base class of\n  that type (or a reference to it), or to (possibly cv-qualified)\n  <code>void</code>.</p>\n</blockquote>\n", "OwnerUserId": "2756719", "PostTypeId": "2", "Id": "32130042", "Score": "4", "CreationDate": "2015-08-20T23:25:18.077", "LastActivityDate": "2015-08-20T23:25:18.077"}, "bq_ids": {"n4140": {"so_32129263_32130042_0": {"section_id": 391, "quality": 1.0, "length": 22}}, "n3337": {"so_32129263_32130042_0": {"section_id": 382, "quality": 1.0, "length": 22}}, "n4659": {"so_32129263_32130042_0": {"section_id": 408, "quality": 1.0, "length": 22}}}});