post_cb({"14903883": {"CommentCount": "6", "ViewCount": "161", "PostTypeId": "1", "LastEditorUserId": "1168156", "CreationDate": "2013-02-15T21:49:00.543", "LastActivityDate": "2013-09-29T08:30:13.820", "Title": "C++ Integer removes string from *char[]", "AcceptedAnswerId": "14903968", "LastEditDate": "2013-09-29T08:30:13.820", "Id": "14903883", "Score": "1", "Body": "<p>I'm trying to read in several values into my C++ program.</p>\n<p>When I enter in a 1 digit number (at the bottom of my code) I'm fine. </p>\n<p>However, if I enter a 2 digit number, like \"10\", the message (the second thing I enter) becomes erased. </p>\n<p>Here is my code:</p>\n<pre><code>char * args[6];\nunsigned time = 5;\nchar input[5];   // for string input\nstring message= \"message\";\n//these strings and *chars are tempary strings for the purpose of reading in data\nstring temp;\nchar *temp2 = \" \";\nchar *temp3 = \"empty pointer\";\n\n     args[count] = \"-m\";\n    count ++;\n\n    //Prompt for the message\n    cout &lt;&lt;endl&lt;&lt;\"Alright, Please enter your message: \"&lt;&lt;flush;\n    getline(cin, message);\n    cout &lt;&lt;endl&lt;&lt;endl;\n    message.append(\"\\\"\");\n    message = \"\\\"\"+message;\n    //we can't use the string, so we copy it to temp3.\n    strcpy(temp3, message.c_str());\n    //Now we input the string into our array of arguments\n    args[count] = temp3;\n    count ++;\n\n\n    cout &lt;&lt;\"Please enter time  \"&lt;&lt;flush;\n    getline(cin,temp);\n\n    //validate input utnil its an actual second.\n    bool done = false;\n    while (done == false){\n        for(unsigned i = 0; i &lt; temp.length() &amp; i &lt; 5; i++){\n            input[i] = temp[i];\n        }\n    done = CheckInteger(input, input);\n        time = atoi(input);\n        if (done == true &amp; time &lt; 1) {\n            cout &lt;&lt;\"Unable to use a number less than 1 seconds!  \"&lt;&lt;endl;\n            cout &lt;&lt;\"Please enter the number of seconds?  \"&lt;&lt;flush;\n            done = false;\n        }else if (done == false){\n            cout &lt;&lt;\"Please enter the number of seconds?  \"&lt;&lt;flush;\n        }else{\n        break;\n        }\n        getline(cin,temp);\n    }\n    cout &lt;&lt;endl&lt;&lt;endl;\n    time = atoi(input);\n    //timer argument\n    args[count] = \"-t\";\n    count ++;\n\n    // enter the time need to comvert from int to string.\n    ostringstream convert;\n    convert &lt;&lt;time;\n    temp = convert.str();\n    //need to convert from string to character\n    strcpy(temp2, temp.c_str());\n\n    args[count] = temp2;\n    count ++;\n</code></pre>\n<p>How can I fix this?</p>\n", "Tags": "<c++><string><pointers><int><string-literals>", "OwnerUserId": "1797035", "AnswerCount": "1"}, "14903968": {"ParentId": "14903883", "PostTypeId": "2", "CommentCount": "5", "Body": "<p><a href=\"http://www.cplusplus.com/reference/cstring/strcpy/\" rel=\"nofollow\"><code>strcpy(char* destination, const char* source)</code></a> copies the <code>source</code> string into the array pointed by <code>destination</code>. But you are calling <code>strcpy(temp3, message.c_str());</code> that tries to copy the string into the pointer to constant string literal: <code>char *temp3 = \"empty pointer\";</code>, which leads to <strong>undefined behaviour</strong> [1]</p>\n<p>Change <code>temp3</code> from pointer to an array that will be just initialized with this string literal:</p>\n<pre><code>char temp3[] = \"empty pointer\";\n</code></pre>\n<p>or even better: use <code>std::string</code> instead.</p>\n<hr>\n<p>[1] <strong>C++03 Standard 2.13.4 String literals</strong> (selected parts)<strong>:</strong></p>\n<blockquote>\n<p id=\"so_14903883_14903968_0\"><strong>\u00a71</strong> An ordinary string literal has type \u201carray of <em>n</em> <code>const char</code>\u201d and static storage duration</p>\n<p id=\"so_14903883_14903968_1\"><strong>\u00a72 The effect of attempting to modify a string literal is undefined.</strong></p>\n</blockquote>\n</hr>", "OwnerUserId": "1168156", "LastEditorUserId": "1168156", "LastEditDate": "2013-02-15T22:06:08.297", "Id": "14903968", "Score": "4", "CreationDate": "2013-02-15T21:54:12.490", "LastActivityDate": "2013-02-15T22:06:08.297"}, "bq_ids": {"n4140": {"so_14903883_14903968_0": {"section_id": 5356, "quality": 0.9, "length": 9}, "so_14903883_14903968_1": {"section_id": 5361, "quality": 0.8571428571428571, "length": 6}}, "n3337": {"so_14903883_14903968_0": {"section_id": 5153, "quality": 0.9, "length": 9}, "so_14903883_14903968_1": {"section_id": 5157, "quality": 0.8571428571428571, "length": 6}}, "n4659": {"so_14903883_14903968_0": {"section_id": 6781, "quality": 0.9, "length": 9}, "so_14903883_14903968_1": {"section_id": 6789, "quality": 0.8571428571428571, "length": 6}}}});