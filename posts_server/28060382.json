post_cb({"28060382": {"CommentCount": "2", "AcceptedAnswerId": "28060940", "OwnerDisplayName": "user2953119", "CreationDate": "2015-01-21T05:43:18.210", "LastActivityDate": "2015-01-21T06:32:55.750", "PostTypeId": "1", "ViewCount": "81", "FavoriteCount": "0", "Title": "Class declaration within a function declaration", "Id": "28060382", "Score": "3", "Body": "<p>Consider the following example:</p>\n<pre><code>#include &lt;iostream&gt;\n\nvoid foo(class B, B *b); \n\nB *c; //OK\n\nint main(){ }\n</code></pre>\n<p><strong><a href=\"http://coliru.stacked-crooked.com/a/e5b752ca449fe68b\" rel=\"nofollow\">DEMO</a></strong></p>\n<p>The Standard <code>N4296::3.3.2/7.1 [basic.scope.pdecl]</code></p>\n<blockquote>\n<p id=\"so_28060382_28060382_0\">\u2014 for a declaration of the form</p>\n<p id=\"so_28060382_28060382_1\"><em>class-key attribute-specifier-seqopt identifier;</em></p>\n<p id=\"so_28060382_28060382_2\">the identifier is declared to be a class-name in the scope that\n  contains the declaration</p>\n</blockquote>\n<p>, but according to <code>N4296:3.3.4/1 [basic.scope.proto]</code></p>\n<blockquote>\n<p id=\"so_28060382_28060382_3\">In a function declaration, or in any function declarator except the\n  declarator of a function definition (8.4), names of parameters (if\n  supplied) have function prototype scope, which terminates at the end\n  of the nearest enclosing function declarator.</p>\n</blockquote>\n<p>So, the <code>class B</code> should have been introduced in the function prototype scope. And the scope of <code>B</code> should have been up to the end of the <code>foo</code>'s declarator. But the name is visible in the global scope. Why?</p>\n", "Tags": "<c++><function><class>", "AnswerCount": "1"}, "28060940": {"ParentId": "28060382", "CommentCount": "0", "Body": "<p>You are quoting the wrong bullet in 3.3.2 [basic.scope.pdecl]/p7. The <code>class B</code> in the declaration of <code>foo</code> is not of the form <code>class-key attribute-specifier-seq_opt identifier;</code> - there is no semicolon.</p>\n<p>Instead, the second bullet applies:</p>\n<blockquote>\n<p id=\"so_28060382_28060940_0\">for an <em>elaborated-type-specifier</em> of the form</p>\n<p id=\"so_28060382_28060940_1\"><em>class-key identifier</em></p>\n<p id=\"so_28060382_28060940_2\">if the <em>elaborated-type-specifier</em> is used in the <em>decl-specifier-seq</em>\n  or <em>parameter-declaration-clause</em> of a function defined in namespace\n  scope, the identifier is declared as a <em>class-name</em> in the namespace\n  that contains the declaration; otherwise, except as a friend\n  declaration, the identifier is declared in the smallest namespace or\n  block scope that contains the declaration.</p>\n</blockquote>\n<p>Hence, the <em>elaborated-type-specifier</em> <code>class B</code> in your example declares <code>B</code> as a <em>class-name</em> in the namespace containing the declaration of <code>foo</code> - i.e., the global namespace.</p>\n", "OwnerUserId": "2756719", "PostTypeId": "2", "Id": "28060940", "Score": "6", "CreationDate": "2015-01-21T06:32:55.750", "LastActivityDate": "2015-01-21T06:32:55.750"}, "bq_ids": {"n4140": {"so_28060382_28060382_3": {"section_id": 7065, "quality": 1.0, "length": 21}, "so_28060382_28060382_2": {"section_id": 7055, "quality": 1.0, "length": 6}, "so_28060382_28060940_2": {"section_id": 7055, "quality": 1.0, "length": 25}}, "n3337": {"so_28060382_28060382_3": {"section_id": 6809, "quality": 1.0, "length": 21}, "so_28060382_28060382_2": {"section_id": 6799, "quality": 1.0, "length": 6}, "so_28060382_28060940_2": {"section_id": 6799, "quality": 1.0, "length": 25}}, "n4659": {"so_28060382_28060382_3": {"section_id": 8562, "quality": 1.0, "length": 21}, "so_28060382_28060382_2": {"section_id": 8552, "quality": 1.0, "length": 6}, "so_28060382_28060940_2": {"section_id": 8552, "quality": 1.0, "length": 25}}}});