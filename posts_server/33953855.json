post_cb({"33953855": {"CommentCount": "0", "AcceptedAnswerId": "33959840", "LastEditDate": "2015-11-27T09:36:03.760", "LastEditorUserId": "5467838", "CreationDate": "2015-11-27T09:11:35.527", "LastActivityDate": "2015-11-27T14:47:19.533", "PostTypeId": "1", "ViewCount": "478", "Title": "QT 5.5.1 .so library with android", "Id": "33953855", "OwnerUserId": "5467838", "Body": "<p>I have downloaded openssl compiled library for armeabi and x86 android platforms from <a href=\"https://github.com/emileb/OpenSSL-for-Android-Prebuilt\" rel=\"nofollow\">here</a> and tried to load it in the .pro file:</p>\n<pre><code>INCLUDEPATH += C:\\Temp\\openssl\\OpenSSL-for-Android-Prebuilt\\openssl-1.0.2\\include\\\nLIBS += -LC:\\Temp\\openssl\\OpenSSL-for-Android-Prebuilt\\openssl-1.0.2\\armeabi-v7a\\lib \\\n-llibssl\n-llibcrypto\n</code></pre>\n<p>I have also tried with <code>-llibssl.so -llibcrypto.so</code> and <code>-llibssl.a -llibcrypto.a</code> but this error occures:</p>\n<blockquote>\n<p id=\"so_33953855_33953855_0\">collect2.exe:-1: error: error: ld returned 1 exit status</p>\n</blockquote>\n<p>The code is simple usage of SHA1 and it is running on MSVC 12.0 with .lib libraries successfully:</p>\n<p><strong>mainwindow.cpp</strong></p>\n<pre><code>#include \"mainwindow.h\"\n#include \"ui_mainwindow.h\"\n#include \"QMessageBox\"\n#include &lt;openssl/sha.h&gt;\n\nMainWindow::MainWindow(QWidget *parent) :\n    QMainWindow(parent),\n    ui(new Ui::MainWindow)\n{\n    ui-&gt;setupUi(this);\n    const unsigned char ibuf[] = \"compute sha1\";\n    const char ibuf1[] = \"compute sha1\";\n    unsigned char obuf[20];\n\n    SHA1(ibuf, strlen(ibuf1), obuf);\n\n    int i;\n    for (i = 0; i &lt; 20; i++) {\n        printf(\"%02x \", obuf[i]);\n    }\n    printf(\"\\n\");\n}\n\nMainWindow::~MainWindow()\n{\n    delete ui;\n}\n\nvoid MainWindow::on_pushButton_clicked()\n{\n    QMessageBox::about(this,tr(\"Test\"),tr(\"Hellow man!!!\"));\n}\n</code></pre>\n<p>Of course I have read forums so here is the full log:</p>\n<pre><code>C:\\Users\\niki\\Downloads\\android-ndk-r10e/toolchains/arm-linux-androideabi-4.9/prebuilt/windows/bin/arm-linux-androideabi-g++ --sysroot=C:\\Users\\niki\\Downloads\\android-ndk-r10e/platforms/android-9/arch-arm/ -Wl,-soname,libtestAndroid.so -Wl,--no-undefined -Wl,-z,noexecstack -shared -o libtestAndroid.so main.obj mainwindow.obj moc_mainwindow.obj   -LC:\\Users\\niki\\Downloads\\android-ndk-r10e/sources/cxx-stl/gnu-libstdc++/4.9/libs/armeabi -LC:\\Users\\niki\\Downloads\\android-ndk-r10e/platforms/android-9/arch-arm//usr/lib -LC:/Qt/5.5/android_armv5/lib -lQt5Widgets -Lc:\\utils\\android\\ndk/sources/cxx-stl/gnu-libstdc++/4.8/libs/armeabi -Lc:\\utils\\android\\ndk/platforms/android-9/arch-arm//usr/lib -lQt5Gui -lQt5Core -lGLESv2 -lgnustl_shared -llog -lz -lm -ldl -lc -lgcc\nmainwindow.obj:mainwindow.cpp:function MainWindow::MainWindow(QWidget*): error: undefined reference to 'SHA1'\ncollect2.exe: error: ld returned 1 exit status\nmakefile:83: recipe for target 'libtestAndroid.so' failed\nmingw32-make: *** [libtestAndroid.so] Error 1\n10:47:05: The process \"C:\\Qt\\Tools\\mingw492_32\\bin\\mingw32-make.exe\" exited with code 2.\nError while building/deploying project testAndroid (kit: Android for armeabi (GCC 4.9, Qt 5.5.1))\nWhen executing step \"Make\"\n</code></pre>\n<p>It seems that SHA1 is the problem. In sha.h it is defined</p>\n<pre><code>#ifdef  __cplusplus\nextern \"C\" {\n#endif\n#ifdef  __cplusplus\n}\n#endif\n</code></pre>\n<p>so this is not the issue. There is some Android.mk file. What to do? Should I load it somehow in .pro file? I just wanted to try usage of openssl in android before compile it to be shure it is possible to work(because compilling will take time and must be done on linux). </p>\n", "Tags": "<android><c++><qt><openssl><shared-libraries>", "Score": "0", "AnswerCount": "1"}, "33959840": {"ParentId": "33953855", "CommentCount": "0", "Body": "<p>My question was noobie. Seems when you want to link shared libraries begining with \"lib\" you should miss it so in my case this worked:</p>\n<pre><code>INCLUDEPATH += C:\\Temp\\openssl\\OpenSSL-for-Android-Prebuilt\\openssl-1.0.2\\include\\\nLIBS += -LC:\\Temp\\openssl\\OpenSSL-for-Android-Prebuilt\\openssl-1.0.2\\armeabi-v7a\\lib -lssl\nLIBS += -LC:\\Temp\\openssl\\OpenSSL-for-Android-Prebuilt\\openssl-1.0.2\\armeabi-v7a\\lib -lcrypto\n</code></pre>\n<p>Notice I have separated <code>libcrypto.so and libssl.so</code> from  <code>libcrypto.a and libssl.a</code> in two directories - lib and lib1. For me only static libs(.a) worked, shared libs give me error.</p>\n", "OwnerUserId": "5467838", "PostTypeId": "2", "Id": "33959840", "Score": "0", "CreationDate": "2015-11-27T14:47:19.533", "LastActivityDate": "2015-11-27T14:47:19.533"}, "bq_ids": {"n4659": {"so_33953855_33953855_0": {"section_id": 3213, "quality": 0.6666666666666666, "length": 4}}}});