post_cb({"30997287": {"ParentId": "30997129", "PostTypeId": "2", "CommentCount": "3", "Body": "<p>GCC and clang are right, VC++ is wrong.</p>\n<blockquote>\n<p id=\"so_30997129_30997287_0\">2.2 Phases of translation [lex.phases]:</p>\n<p id=\"so_30997129_30997287_1\">[...]</p>\n<ol start=\"3\">\n<li><p id=\"so_30997129_30997287_2\">The source file is decomposed into <strong>preprocessing tokens (2.5)</strong> and sequences of white-space characters (including comments).</p></li>\n<li><p id=\"so_30997129_30997287_3\"><strong>Preprocessing directives</strong> are executed, [...]</p></li>\n</ol>\n</blockquote>\n<p>And <strong><em>2.5 Preprocessing tokens [lex.pptoken]</em></strong> lists <em><code>string-literals</code></em> amongst the tokens.</p>\n<p>Consequently, parsing is required to tokenise the string literal first, \"consuming\" the <code>#else</code> and <code>dostuff</code> function definition.</p>\n", "OwnerUserId": "410767", "LastEditorUserId": "410767", "LastEditDate": "2015-06-23T08:37:56.613", "Id": "30997287", "Score": "32", "CreationDate": "2015-06-23T08:12:29.053", "LastActivityDate": "2015-06-23T08:37:56.613"}, "bq_ids": {"n4140": {"so_30997129_30997287_2": {"section_id": 5313, "quality": 0.9166666666666666, "length": 11}}, "n3337": {"so_30997129_30997287_2": {"section_id": 5110, "quality": 0.9166666666666666, "length": 11}}, "n4659": {"so_30997129_30997287_2": {"section_id": 6737, "quality": 0.9166666666666666, "length": 11}}}, "30997129": {"CommentCount": "7", "AcceptedAnswerId": "30997287", "PostTypeId": "1", "LastEditorUserId": "4370109", "CreationDate": "2015-06-23T08:02:59.093", "LastActivityDate": "2016-07-05T16:58:01.733", "LastEditDate": "2016-07-05T16:58:01.733", "ViewCount": "1215", "FavoriteCount": "1", "Title": "In C++11 what should happen first: raw string expansion or macros?", "Id": "30997129", "Score": "39", "Body": "<p>This code works in Visual C++ 2013 but not in gcc/clang:</p>\n<pre><code>#if 0\nR\"foo(\n#else\nint dostuff () { return 23; }\n// )foo\";\n#endif\ndostuff();\n</code></pre>\n<p>Visual C++ removes the if 0 first. Clang expands the R raw string first (and never defining dostuff). Who is right and why?</p>\n", "Tags": "<c++><c++11><c-preprocessor><rawstring>", "OwnerUserId": "360270", "AnswerCount": "1"}});