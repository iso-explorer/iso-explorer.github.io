post_cb({"bq_ids": {"n4140": {"so_27840695_27840837_1": {"length": 24, "quality": 0.7272727272727273, "section_id": 5941}, "so_27840695_27840837_0": {"length": 16, "quality": 0.8421052631578947, "section_id": 6076}, "so_27840695_27840837_4": {"length": 7, "quality": 0.7777777777777778, "section_id": 5959}, "so_27840695_27840837_2": {"length": 10, "quality": 1.0, "section_id": 5959}}, "n3337": {"so_27840695_27840837_1": {"length": 21, "quality": 0.6363636363636364, "section_id": 5712}, "so_27840695_27840837_0": {"length": 16, "quality": 0.8421052631578947, "section_id": 5844}, "so_27840695_27840837_4": {"length": 7, "quality": 0.7777777777777778, "section_id": 5728}, "so_27840695_27840837_2": {"length": 10, "quality": 1.0, "section_id": 5728}}, "n4659": {"so_27840695_27840837_1": {"length": 21, "quality": 0.6363636363636364, "section_id": 7425}, "so_27840695_27840837_0": {"length": 16, "quality": 0.8421052631578947, "section_id": 7572}, "so_27840695_27840837_4": {"length": 7, "quality": 0.7777777777777778, "section_id": 7440}, "so_27840695_27840837_2": {"length": 10, "quality": 1.0, "section_id": 7440}}}, "27840695": {"ViewCount": "62", "Body": "<p>I came over the following code construct in our production environment (heavily simplified however).</p>\n<pre><code>#include &lt;iostream&gt;\n\ntypedef struct \n{\n    char entry[10]; \n}\ninn_struct;\n\ntypedef struct \n{    \n    inn_struct directory;\n} \nout_struct;\n\n\nstruct test\n{\n    static const int \n       ENTRY_LENGTH = (sizeof((static_cast&lt;out_struct*&gt;(0))-&gt;directory.entry) \n           / sizeof((static_cast&lt;out_struct*&gt;(0))-&gt;directory.entry[0]));\n};\n\nint main()\n{\n    test a;\n    std::cout &lt;&lt; test::ENTRY_LENGTH;\n}\n</code></pre>\n<p>Now not considering the obviously obfuscated nature of it since it's just the old C way of determining the length of an array ... I am really bothered by the <code>static_cast</code> of the <code>0</code> value. ... Is this code acceptable? Can you please attach some passages from the c++ standard to your response which tells me (if) why this code is ok?</p>\n", "AcceptedAnswerId": "27840837", "Title": "Strange usage of static_cast", "CreationDate": "2015-01-08T12:56:21.447", "Id": "27840695", "CommentCount": "0", "PostTypeId": "1", "LastActivityDate": "2015-01-08T14:15:02.370", "Score": "1", "OwnerUserId": "186193", "Tags": "<c++><null><zero><static-cast>", "AnswerCount": "1"}, "27840837": {"Id": "27840837", "PostTypeId": "2", "Body": "<p>Yes, this code is perfectly acceptable. See \u00a75.3.3/1 (emphasis mine).</p>\n<blockquote>\n<p id=\"so_27840695_27840837_0\">The sizeof operator yields the number of bytes in the object representation of its operand. The operand is either an expression, which is an <strong>unevaluated</strong> operand (Clause 5), or a paranthesized <em>type-id</em>.</p>\n</blockquote>\n<p>The expression is not evaluated, so there's no problem with what looks like dereferencing a null pointer. </p>\n<p>Note also that in C++11, you don't need to jump through that hoop, and can just directly reference the class member with sizeof, thanks to \u00a75/8 (emphasis mine):</p>\n<blockquote>\n<p id=\"so_27840695_27840837_1\">In some contexts, <em>unevaluated operands</em> appear (5.2.8, 5.3.3, 5.3.7, 7.1.6.2). An unevaluated operand is not evaluated. An unevaluated operand is considered a full-expression. [ <em>Note:</em> In an unevaluated operand, <strong>a non-static class member may be named</strong> (5.1) and naming of objects or functions does not, by itself, require that a definition be provided (3.2). \u2014 <em>end note</em> ]</p>\n</blockquote>\n<p>and \u00a75.1.1/13:</p>\n<blockquote>\n<p id=\"so_27840695_27840837_2\">An <em>id-expression</em> that denotes a non-static data member or non-static member function of a class can only be used:</p>\n<ul>\n<li><p id=\"so_27840695_27840837_3\">..</p></li>\n<li><p id=\"so_27840695_27840837_4\">if that <em>id-expression</em> denotes a non-static data member and it appears in an unevaluated context <em>[Example:</em></p></li>\n</ul>\n</blockquote>\n<pre><code>    struct S {\n      int m;\n    };\n\n    int i = sizeof(S::m); // OK\n    int j = sizeof(S::m + 42); // OK\n</code></pre>\n<blockquote>\n<p id=\"so_27840695_27840837_5\"><em>- end example]</em></p>\n</blockquote>\n", "LastEditorUserId": "2069064", "LastActivityDate": "2015-01-08T14:15:02.370", "Score": "4", "CreationDate": "2015-01-08T13:04:38.587", "ParentId": "27840695", "CommentCount": "2", "OwnerUserId": "2069064", "LastEditDate": "2015-01-08T14:15:02.370"}});