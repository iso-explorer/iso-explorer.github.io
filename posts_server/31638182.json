post_cb({"bq_ids": {"n4140": {"so_31638182_31638279_0": {"length": 10, "quality": 0.9090909090909091, "section_id": 3312}}, "n3337": {"so_31638182_31638279_0": {"length": 10, "quality": 0.9090909090909091, "section_id": 3182}}, "n4659": {"so_31638182_31638279_0": {"length": 10, "quality": 0.9090909090909091, "section_id": 4078}}}, "31638279": {"Id": "31638279", "PostTypeId": "2", "Body": "<p><code>{ .QuadPart = 0 };</code> is illegal in C++. Designated initializers are C-only. You link to a <a class=\"post-tag\" href=\"/questions/tagged/c\" rel=\"tag\" title=\"show questions tagged 'c'\">c</a> question.</p>\n<p>In C++03 [dcl.init.aggr]/15:  (your union is an aggregate):</p>\n<blockquote>\n<p id=\"so_31638182_31638279_0\">When a union is initialized with a brace-enclosed initializer, the braces shall only contain an initializer for the first member of the union.</p>\n</blockquote>\n<p>So, it is not possible to initialize \"the largest member\" unless that member is the first member.</p>\n<hr>\n<p>The MinGW warning is bogus. g++ used to issue warnings for <code>= { 0 };</code>, however that is a common idiom, so they fixed it to not do that any more. I guess you have a slightly old version.</p>\n<p>In your code, <code>= { 0 };</code> should initialize <code>DUMMYSTRUCTNAME</code> to <code>{0, 0}</code>. According to <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa383751(v=vs.85).aspx\" rel=\"nofollow\">this</a>,  all members of your union are 64-bit so in this particular case, you did actually initialize the largest member.</p>\n</hr>", "LastEditorUserId": "1505939", "LastActivityDate": "2015-07-26T14:50:27.747", "Score": "3", "CreationDate": "2015-07-26T14:44:13.213", "ParentId": "31638182", "CommentCount": "5", "OwnerUserId": "1505939", "LastEditDate": "2015-07-26T14:50:27.747"}, "31638182": {"ViewCount": "558", "Body": "<p>I'm trying to initialize a <code>LARGE_INTEGER</code> to 0 in a C++ library (C++03 to be exact). Previously, the initialization was:</p>\n<pre><code>static LARGE_INTEGER freq = { 0 };\n</code></pre>\n<p>Under MinGW it produced a warning:</p>\n<blockquote>\n<p id=\"so_31638182_31638182_0\">missing initializer for member '_LARGE_INTEGER::::HighPart'</p>\n</blockquote>\n<p>So I changed the initialization to the following in accordance with <a href=\"https://stackoverflow.com/a/2149001/608639\">Can a union be initialized in the declaration?</a>:</p>\n<pre><code>static LARGE_INTEGER freq = { .QuadPart = 0 };\n</code></pre>\n<p>I'm now testing under Visual Studio 2015, and its producing an error:</p>\n<pre><code>81  static LARGE_INTEGER freq = { .QuadPart = 0 };\n82  if (freq.QuadPart == 0)\n83  {\n84      if (!QueryPerformanceFrequency(&amp;freq))\n85          throw Exception(Exception::OTHER_ERROR, \"Timer: QueryPerformanceFrequency failed ...\"));\n86 }\n\nhrtimer.cpp(81): error C2059: syntax error: '.'\nhrtimer.cpp(81): error C2143: syntax error: missing ';' before '}'\nhrtimer.cpp(82): error C2059: syntax error: 'if'\nhrtimer.cpp(83): error C2143: syntax error: missing ';' before '{'\nhrtimer.cpp(83): error C2447: '{': missing function header (old-style formal list?)\nhrtimer.cpp(87): error C2059: syntax error: 'return'\n</code></pre>\n<p>How do I initialize a union to its largest member under the MSVC compiler?</p>\n<hr>\n<p>Here is Microsoft's definiton of <code>LARGE_INTEGER</code>:</p>\n<pre><code>#if defined(MIDL_PASS)\ntypedef struct _LARGE_INTEGER {\n#else // MIDL_PASS\ntypedef union _LARGE_INTEGER {\n    struct {\n        DWORD LowPart;\n        LONG HighPart;\n    } DUMMYSTRUCTNAME;\n    struct {\n        DWORD LowPart;\n        LONG HighPart;\n    } u;\n#endif //MIDL_PASS\n    LONGLONG QuadPart;\n} LARGE_INTEGER;\n</code></pre>\n</hr>", "AcceptedAnswerId": "31638279", "Title": "Initialize union using largest member under MSVC compiler", "CreationDate": "2015-07-26T14:34:30.480", "Id": "31638182", "CommentCount": "9", "FavoriteCount": "1", "PostTypeId": "1", "LastEditDate": "2017-05-23T12:00:47.507", "LastEditorUserId": "-1", "LastActivityDate": "2015-08-27T07:45:15.067", "Score": "2", "OwnerUserId": "608639", "Tags": "<c++><initialization><visual-studio-2015><unions><c++03>", "AnswerCount": "1"}});