post_cb({"6174034": {"ParentId": "6173872", "CommentCount": "3", "Body": "<p>I think you are asking for the rationale and not the specific language rule that allows this.</p>\n<p>The rationale for this is that it makes <code>const</code> variables much easier to use. It gives a typed replacement for one common use of <code>#define</code>.</p>\n<p>Instead of <code>#define MAX_COUNT 211</code> you can use <code>const int max_count = 211;</code> in exactly the same way, e.g. a shared header file, without having to worry about where to put the one definition.</p>\n<p>You can't legally change the value of a <code>const</code> object so there's no visible difference between having one object and multiple objects with the same value.</p>\n<p>As you can put a definition of a <code>const</code> object in a header file it makes trivial for the compiler to use the value directly at the compilation stage without such optimizations having to be delayed to a link-time fixup.</p>\n", "OwnerUserId": "19563", "PostTypeId": "2", "Id": "6174034", "Score": "7", "CreationDate": "2011-05-30T08:38:19.160", "LastActivityDate": "2011-05-30T08:38:19.160"}, "6173872": {"CommentCount": "4", "ViewCount": "8104", "PostTypeId": "1", "LastEditorUserId": "15416", "CreationDate": "2011-05-30T08:19:44.870", "LastActivityDate": "2013-10-22T02:59:16.627", "Title": "Why is multiple definition of a const global variable allowed in C++ and not in C?", "FavoriteCount": "10", "LastEditDate": "2011-05-31T10:35:13.807", "Id": "6173872", "Score": "27", "Body": "<p>Multiple definition of a global variable is not allowed in C or C++ due to the One Definition Rule. However, in C++ a const global variable can be defined in multiple compilation units with no error. This is not the same as in C.</p>\n<p>Why does C++ allow this while C does not? Why does the usage and behaviour of a const global differ from a non-const global in this way in C++ compared to C? What is happening under the covers with C++ and C with respect to const?</p>\n<p>For example this is allowed in C++, but wrong in C:</p>\n<pre><code>// Foo.cpp\nconst int Foo = 99;\n\n// Main.cpp\nconst int Foo = 99;\nint main()\n{\n    cout &lt;&lt; Foo &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n<p>And this is fine with C, but wrong with C++:</p>\n<pre><code>// Foo.cpp\nconst int Foo = 99;\n\n// Main.cpp\nextern const int Foo;\nint main()\n{\n    cout &lt;&lt; Foo &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n", "Tags": "<c++><c><const><one-definition-rule>", "OwnerUserId": "1630", "AnswerCount": "6"}, "6174224": {"ParentId": "6173872", "CommentCount": "0", "Body": "<p>Basically, in C++, const, non-local variables are genuine constant expressions, or constexpr. This permits plenty of things, like TMP.</p>\n<pre><code>const int five = 5;\nint main() {\n    int x[five];\n    std::array&lt;int, five&gt; arr;\n}\n</code></pre>\n<p>In C, they are just a variable that cannot be modified. That is,</p>\n<pre><code>const int five = 5;\nint main() {\n    int x[five]; // Technically, this is a variable length array\n}\n</code></pre>\n<p>Is quite equivalent to</p>\n<pre><code>int five = 5;\nint main() {\n    int x[five];\n}\n</code></pre>\n<p>Effectively, C++ promotes some kinds of <code>const</code> variable to a new category, <code>constexpr</code>, whereas in C, this does not exist and they are just variables which happen to be unmodifiable.</p>\n", "OwnerUserId": "298661", "PostTypeId": "2", "Id": "6174224", "Score": "6", "CreationDate": "2011-05-30T08:59:44.960", "LastActivityDate": "2011-05-30T08:59:44.960"}, "19508052": {"ParentId": "6173872", "PostTypeId": "2", "CommentCount": "0", "Body": "<p>My workaround was declaring it as :</p>\n<pre><code>static classfoo foo;\n</code></pre>\n<p>it worked in my situation.  </p>\n", "OwnerUserId": "8681061", "LastEditorUserId": "1277532", "LastEditDate": "2013-10-22T02:59:16.627", "Id": "19508052", "Score": "-2", "CreationDate": "2013-10-22T02:32:48.327", "LastActivityDate": "2013-10-22T02:59:16.627"}, "10449303": {"ParentId": "6173872", "CommentCount": "1", "Body": "<p><em>Why do English people spell COLOUR, whereas American people spells it COLOR?</em></p>\n<p>They are 2 different languages from the same base, but they don't have the same rules.  </p>\n<p>C &amp; C++ are the same.  If they weren't different, they would both be called the same thing.</p>\n", "OwnerUserId": "759558", "PostTypeId": "2", "Id": "10449303", "Score": "0", "CreationDate": "2012-05-04T13:00:01.543", "LastActivityDate": "2012-05-04T13:00:01.543"}, "6173889": {"ParentId": "6173872", "PostTypeId": "2", "CommentCount": "5", "Body": "<pre><code>// Foo.cpp\nconst int Foo = 99;\n\n// Main.cpp\nconst int Foo = 99;\n</code></pre>\n<p><code>const</code> variable at namespace scope has <em>internal</em> linkage. So they're basically two different variables.  There is no redefinition.</p>\n<p>From @David's comment, 3.5/3 [basic.link]: </p>\n<blockquote>\n<p id=\"so_6173872_6173889_0\">A name having namespace scope (3.3.5)\n  has <strong>internal linkage</strong> if it is the name\n  of<br>\n  \u2014 an object, reference, function or\n  function template that is explicitly\n  declared static or,<br>\n  \u2014 an object or\n  reference that is <strong>explicitly declared\n  const and neither explicitly declared\n  extern nor previously declared to have\n  external linkage</strong>; or<br>\n  \u2014 a data member\n  of an anonymous union.</br></br></br></p>\n</blockquote>\n<hr>\n<p>In the second case, you should be doing this (correct way):</p>\n<pre><code>//Foo.h\nextern const int Foo; //use extern here to make it have external linkage!\n\n// Foo.cpp\n#include \"Foo.h\"\nconst int Foo = 99; //actual definition goes here\n\n// Main.cpp\n#include \"Foo.h\"\nint main()\n{\n   cout &lt;&lt; Foo &lt;&lt; endl;\n}\n</code></pre>\n</hr>", "OwnerUserId": "415784", "LastEditorUserId": "415784", "LastEditDate": "2011-06-11T22:32:01.713", "Id": "6173889", "Score": "27", "CreationDate": "2011-05-30T08:21:17.800", "LastActivityDate": "2011-06-11T22:32:01.713"}, "6173901": {"ParentId": "6173872", "PostTypeId": "2", "CommentCount": "1", "Body": "<p>It looks like <em>const</em> <a href=\"https://stackoverflow.com/questions/998425/why-does-const-imply-internal-linkage-in-c-when-it-doesnt-in-c\">doesn't actually generate an external symbol</a>.</p>\n", "OwnerUserId": "23643", "LastEditorUserId": "-1", "LastEditDate": "2017-05-23T10:30:49.480", "Id": "6173901", "Score": "3", "CreationDate": "2011-05-30T08:22:53.113", "LastActivityDate": "2011-05-30T08:28:49.927"}, "bq_ids": {"n4140": {"so_6173872_6173889_0": {"section_id": 7136, "quality": 0.8571428571428571, "length": 30}}, "n3337": {"so_6173872_6173889_0": {"section_id": 6880, "quality": 0.8571428571428571, "length": 30}}, "n4659": {"so_6173872_6173889_0": {"section_id": 8637, "quality": 0.7714285714285715, "length": 27}}}});