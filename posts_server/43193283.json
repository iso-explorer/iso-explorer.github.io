post_cb({"bq_ids": {"n4140": {"so_43193283_43193283_0": {"length": 5, "quality": 0.8333333333333334, "section_id": 5921}}, "n3337": {"so_43193283_43193283_0": {"length": 5, "quality": 0.8333333333333334, "section_id": 5693}}, "n4659": {"so_43193283_43193283_0": {"length": 5, "quality": 0.8333333333333334, "section_id": 7395}}}, "43193283": {"ViewCount": "39", "Body": "<p>Consider this snippet:</p>\n<pre><code>#include&lt;iostream&gt;\nstruct S {\n    int bf1:16, bf2:7;\n    char bf3:8;\n} s;\n\nstruct A{\n    int i;\n    char c;\n};\n\nint main() {\n    std::cout &lt;&lt; sizeof(S) &lt;&lt; '\\n';\n    std::cout &lt;&lt; sizeof(A) &lt;&lt; '\\n';\n}\n</code></pre>\n<p>clang and GCC print the following values for the code above (see <a href=\"http://coliru.stacked-crooked.com/a/60e3a7395a193220\" rel=\"nofollow noreferrer\">live example</a>):</p>\n<pre><code>4\n8\n</code></pre>\n<p>That is, it allocates the bit-field <code>bf3</code> as if I had defined struct S as follows:</p>\n<pre><code>struct S{\n    int bf1:16, bf2:7, bf3:8\n};\n</code></pre>\n<p>That doesn't seem to be correct.</p>\n<p>Note also, that if I define the bit-field <code>bf3</code> with 9 bits, in the original snippet, both compilers emit a warning saying that the 9 bits exceed the width of its type, a <code>char</code>, but now they print 8 bytes for the struct S. That's strange, as it's still possible to allocate the 9 bits, as if <code>bf3</code> was declared  in the first <code>int</code> member of the struct.</p>\n<p>I know the Standard says in <a href=\"http://eel.is/c++draft/class.bit#1\" rel=\"nofollow noreferrer\">[class.bit]/1</a> that:</p>\n<blockquote>\n<p id=\"so_43193283_43193283_0\">Allocation of bit-fields within a class object is\n  implementation-defined.</p>\n</blockquote>\n<p>Maybe I'm missing something, but I think there is some inconsistency in the way both compilers are treating this case.</p>\n", "Title": "I'm trying to understand [class.bit]/1, but I found this strange behavior", "CreationDate": "2017-04-03T20:01:14.740", "LastActivityDate": "2017-04-03T20:01:14.740", "CommentCount": "3", "PostTypeId": "1", "Id": "43193283", "Score": "0", "OwnerUserId": "3694387", "Tags": "<c++><language-lawyer><bit-fields>", "AnswerCount": "0"}});