post_cb({"33067600": {"CommentCount": "1", "ViewCount": "111", "PostTypeId": "1", "LastEditorUserId": "4958516", "CreationDate": "2015-10-11T16:53:02.010", "LastActivityDate": "2015-10-11T17:42:45.200", "Title": "What does \"bind directly\" mean in reference initialization?", "AcceptedAnswerId": "33068106", "LastEditDate": "2015-10-11T17:06:44.183", "Id": "33067600", "Score": "2", "Body": "<p>N4527 8.5.3 [dcl.init.ref]</p>\n<blockquote>\n<p id=\"so_33067600_33067600_0\">5 A reference to type \u201ccv1 T1\u201d is initialized by an expression of type \u201ccv2 T2\u201d as follows:</p>\n<p id=\"so_33067600_33067600_1\">(5.1) \u2014 [...]</p>\n<blockquote>\n<p id=\"so_33067600_33067600_16\">(5.1.1) \u2014 [...]</p>\n<p id=\"so_33067600_33067600_17\">(5.1.2) \u2014 [...]</p>\n</blockquote>\n<p id=\"so_33067600_33067600_4\">(5.2) \u2014 Otherwise, the reference shall be an lvalue reference to a non-volatile const type (i.e., cv1 shall be\n  const), or the reference shall be an rvalue reference.</p>\n<blockquote>\n<p id=\"so_33067600_33067600_18\">(5.2.1) \u2014 If the initializer expression</p>\n<blockquote>\n<p id=\"so_33067600_33067600_28\">(5.2.1.1) \u2014 is an xvalue (but not a bit-field), class prvalue, array prvalue or function lvalue and \u201ccv1 T1\u201d\n      is reference-compatible with \u201ccv2 T2\u201d, or</p>\n<p id=\"so_33067600_33067600_29\">(5.2.1.2) \u2014 has a class type (i.e., T2 is a class type), where T1 is not reference-related to T2, and can be\n      converted to an xvalue, class prvalue, or function lvalue of type \u201ccv3 T3\u201d, where \u201ccv1 T1\u201d is\n      reference-compatible with \u201ccv3 T3\u201d (see 13.3.1.6),</p>\n<p id=\"so_33067600_33067600_30\">then the reference is bound to the value of the initializer expression in the first case and to\n      the result of the conversion in the second case (or, in either case, to an appropriate base class\n      subobject).</p>\n</blockquote>\n<p id=\"so_33067600_33067600_22\">(5.2.2) \u2014 Otherwise:</p>\n<blockquote>\n<p id=\"so_33067600_33067600_31\">(5.2.2.1) \u2014 If T1 or T2 is a class type and T1 is not reference-related to T2, user-defined conversions\n      are considered using the rules for copy-initialization of an object of type \u201ccv1 T1\u201d by userdefined\n      conversion (8.5, 13.3.1.4, 13.3.1.5); the program is ill-formed if the corresponding non-reference copy-initialization would be ill-formed. The result of the call to the conversion\n      function, as described for the non-reference copy-initialization, is then used to direct-initialize\n      the reference. For this direct-initialization, user-defined conversions are not considered.</p>\n<p id=\"so_33067600_33067600_32\">(5.2.2.2) \u2014 Otherwise, a temporary of type \u201ccv1 T1\u201d is created and copy-initialized (8.5) from the initializer\n      expression. The reference is then bound to the temporary.</p>\n<p id=\"so_33067600_33067600_33\">If T1 is reference-related to T2:</p>\n<p id=\"so_33067600_33067600_34\">(5.2.2.3) \u2014 cv1 shall be the same cv-qualification as, or greater cv-qualification than, cv2 ; and</p>\n<p id=\"so_33067600_33067600_35\">(5.2.2.4) \u2014 if the reference is an rvalue reference, the initializer expression shall not be an lvalue.</p>\n</blockquote>\n</blockquote>\n<p id=\"so_33067600_33067600_15\">In all cases except the <strong>last</strong> (i.e., creating and initializing a temporary from the initializer expression), the\n  reference is said to <strong>bind directly</strong> to the initializer expression.</p>\n</blockquote>\n<p>What does the \"last case\" mean? 5.2.2(includes 5.2.2.1 and 5.2.2.2) or 5.2.2.2(just one)?</p>\n<p>In other words, is 5.2.2.1 binding directly?</p>\n<pre><code>//case 5.2.1.2\nstruct X{};\n\nstruct Y{Y(X);};\nconst Y&amp; y = X();   // bind directly\n\nstruct Z{operator X();};\nconst X&amp; x = Z();   // bind directly\n\n//case 5.2.2.1\nstruct A{operator int();};\nconst int&amp; a = A(); // bind directly or not?\n\nstruct B{B(int);};\nconst B&amp; b = 1;     // bind directly or not?\n</code></pre>\n", "Tags": "<c++><reference><initialization><language-lawyer>", "OwnerUserId": "4958516", "AnswerCount": "1"}, "33068106": {"ParentId": "33067600", "CommentCount": "0", "Body": "<p>The \"last case\" is referring to 5.2.2.2:</p>\n<blockquote>\n<p id=\"so_33067600_33068106_0\">\u2014 Otherwise, a temporary of type <code>\u201ccv1 T1\u201d</code> is created and copy-initialized (8.5) from the initializer expression. The reference is then bound to the temporary.</p>\n</blockquote>\n<p>This case is contingent on the previous condition being false, which is 5.2.2.1:</p>\n<blockquote>\n<p id=\"so_33067600_33068106_1\">\u2014 If <code>T1</code> or <code>T2</code> is a class type and <code>T1</code> is not <em>reference-related</em> to <code>T2</code>...</p>\n</blockquote>\n<p>This isn't the case for the last two snippets of your example since in the first one <code>A</code> is of class type and <code>int</code> is <em>not</em> reference-related to <code>A</code>. In the second example, <code>B</code> is of class type and <code>B</code> is not reference-related to <code>int</code>. Since these are false 5.2.2.2 doesn't apply (they <em>do</em> bind directly).</p>\n", "OwnerUserId": "701092", "PostTypeId": "2", "Id": "33068106", "Score": "0", "CreationDate": "2015-10-11T17:42:45.200", "LastActivityDate": "2015-10-11T17:42:45.200"}, "bq_ids": {"n4140": {"so_33067600_33067600_15": {"section_id": 3321, "quality": 0.9333333333333333, "length": 14}, "so_33067600_33067600_0": {"section_id": 3321, "quality": 0.75, "length": 6}, "so_33067600_33067600_23": {"section_id": 3321, "quality": 0.8108108108108109, "length": 30}, "so_33067600_33067600_26": {"section_id": 579, "quality": 0.625, "length": 5}, "so_33067600_33067600_11": {"section_id": 3321, "quality": 0.7857142857142857, "length": 11}, "so_33067600_33067600_34": {"section_id": 579, "quality": 0.625, "length": 5}, "so_33067600_33067600_21": {"section_id": 3321, "quality": 1.0, "length": 18}, "so_33067600_33067600_4": {"section_id": 3321, "quality": 0.9166666666666666, "length": 11}, "so_33067600_33067600_31": {"section_id": 3321, "quality": 0.8108108108108109, "length": 30}, "so_33067600_33067600_24": {"section_id": 3321, "quality": 0.7857142857142857, "length": 11}, "so_33067600_33067600_20": {"section_id": 3321, "quality": 0.7727272727272727, "length": 17}, "so_33067600_33067600_27": {"section_id": 3321, "quality": 0.8571428571428571, "length": 6}, "so_33067600_33067600_35": {"section_id": 3321, "quality": 0.8571428571428571, "length": 6}, "so_33067600_33067600_29": {"section_id": 3321, "quality": 0.7727272727272727, "length": 17}, "so_33067600_33067600_14": {"section_id": 3321, "quality": 0.8571428571428571, "length": 6}, "so_33067600_33067600_28": {"section_id": 3321, "quality": 0.7692307692307693, "length": 10}, "so_33067600_33067600_19": {"section_id": 3321, "quality": 0.7692307692307693, "length": 10}, "so_33067600_33067600_13": {"section_id": 579, "quality": 0.625, "length": 5}, "so_33067600_33067600_6": {"section_id": 3321, "quality": 0.7692307692307693, "length": 10}, "so_33067600_33068106_0": {"section_id": 3321, "quality": 0.8461538461538461, "length": 11}, "so_33067600_33067600_30": {"section_id": 3321, "quality": 1.0, "length": 18}, "so_33067600_33067600_10": {"section_id": 3321, "quality": 0.8108108108108109, "length": 30}, "so_33067600_33067600_32": {"section_id": 3321, "quality": 0.7857142857142857, "length": 11}, "so_33067600_33067600_8": {"section_id": 3321, "quality": 1.0, "length": 18}, "so_33067600_33067600_7": {"section_id": 3321, "quality": 0.7727272727272727, "length": 17}}, "n3337": {"so_33067600_33067600_15": {"section_id": 3191, "quality": 0.9333333333333333, "length": 14}, "so_33067600_33067600_0": {"section_id": 3191, "quality": 0.75, "length": 6}, "so_33067600_33067600_26": {"section_id": 569, "quality": 0.625, "length": 5}, "so_33067600_33067600_11": {"section_id": 3191, "quality": 0.7142857142857143, "length": 10}, "so_33067600_33067600_34": {"section_id": 569, "quality": 0.625, "length": 5}, "so_33067600_33067600_21": {"section_id": 3191, "quality": 1.0, "length": 18}, "so_33067600_33067600_4": {"section_id": 3191, "quality": 0.9166666666666666, "length": 11}, "so_33067600_33067600_24": {"section_id": 3191, "quality": 0.7142857142857143, "length": 10}, "so_33067600_33067600_20": {"section_id": 3191, "quality": 0.7272727272727273, "length": 16}, "so_33067600_33067600_27": {"section_id": 3191, "quality": 0.8571428571428571, "length": 6}, "so_33067600_33067600_35": {"section_id": 3191, "quality": 0.8571428571428571, "length": 6}, "so_33067600_33067600_29": {"section_id": 3191, "quality": 0.7272727272727273, "length": 16}, "so_33067600_33067600_14": {"section_id": 3191, "quality": 0.8571428571428571, "length": 6}, "so_33067600_33067600_28": {"section_id": 3191, "quality": 0.6923076923076923, "length": 9}, "so_33067600_33067600_19": {"section_id": 3191, "quality": 0.6923076923076923, "length": 9}, "so_33067600_33067600_13": {"section_id": 569, "quality": 0.625, "length": 5}, "so_33067600_33067600_6": {"section_id": 3191, "quality": 0.6923076923076923, "length": 9}, "so_33067600_33068106_0": {"section_id": 3191, "quality": 0.7692307692307693, "length": 10}, "so_33067600_33067600_30": {"section_id": 3191, "quality": 1.0, "length": 18}, "so_33067600_33067600_32": {"section_id": 3191, "quality": 0.7142857142857143, "length": 10}, "so_33067600_33067600_8": {"section_id": 3191, "quality": 1.0, "length": 18}, "so_33067600_33067600_7": {"section_id": 3191, "quality": 0.7272727272727273, "length": 16}}, "n4659": {"so_33067600_33067600_15": {"section_id": 4087, "quality": 0.7333333333333333, "length": 11}, "so_33067600_33067600_29": {"section_id": 4087, "quality": 0.6818181818181818, "length": 15}, "so_33067600_33067600_31": {"section_id": 4087, "quality": 0.8378378378378378, "length": 31}, "so_33067600_33067600_14": {"section_id": 4087, "quality": 0.8571428571428571, "length": 6}, "so_33067600_33067600_23": {"section_id": 4087, "quality": 0.8378378378378378, "length": 31}, "so_33067600_33067600_26": {"section_id": 602, "quality": 0.625, "length": 5}, "so_33067600_33067600_34": {"section_id": 602, "quality": 0.625, "length": 5}, "so_33067600_33067600_13": {"section_id": 602, "quality": 0.625, "length": 5}, "so_33067600_33067600_0": {"section_id": 4087, "quality": 0.75, "length": 6}, "so_33067600_33067600_21": {"section_id": 4087, "quality": 0.9444444444444444, "length": 17}, "so_33067600_33067600_4": {"section_id": 4087, "quality": 0.9166666666666666, "length": 11}, "so_33067600_33068106_0": {"section_id": 4087, "quality": 0.5384615384615384, "length": 7}, "so_33067600_33067600_30": {"section_id": 4087, "quality": 0.9444444444444444, "length": 17}, "so_33067600_33067600_10": {"section_id": 4087, "quality": 0.8378378378378378, "length": 31}, "so_33067600_33067600_20": {"section_id": 4087, "quality": 0.6818181818181818, "length": 15}, "so_33067600_33067600_27": {"section_id": 4087, "quality": 0.8571428571428571, "length": 6}, "so_33067600_33067600_8": {"section_id": 4087, "quality": 0.9444444444444444, "length": 17}, "so_33067600_33067600_35": {"section_id": 4087, "quality": 0.8571428571428571, "length": 6}, "so_33067600_33067600_7": {"section_id": 4087, "quality": 0.6818181818181818, "length": 15}}}});