post_cb({"6321394": {"ParentId": "6321191", "CommentCount": "0", "Body": "<p>Ise's response is correct -- <a href=\"http://www.comeaucomputing.com/techtalk/templates/#friendclassT\" rel=\"noreferrer\">Comeau's FAQ</a> contains a question concerning this issue in more detail.</p>\n<p>However, perhaps you can try an extra template indirection that might work? Something like this:</p>\n<pre><code>template &lt;typename T&gt;\nstruct FriendMaker\n{\n    typedef T Type;\n};\n\ntemplate &lt;typename T&gt;\nclass CFactory\n{\npublic:\n    friend class FriendMaker&lt;T&gt;::Type;\n};\n</code></pre>\n<p>This seems to only work with gcc 4.5.x however so I wouldn't rely on it.</p>\n", "OwnerUserId": "234175", "PostTypeId": "2", "Id": "6321394", "Score": "5", "CreationDate": "2011-06-12T10:10:12.917", "LastActivityDate": "2011-06-12T10:10:12.917"}, "6321326": {"ParentId": "6321191", "CommentCount": "1", "Body": "<p>Unfortunately, in my understanding, this isn't allowed in current standard.<br>\n\u00a77.1.5.3/2 says:</br></p>\n<blockquote>\n<p id=\"so_6321191_6321326_0\">[Note: ... within a class template\n  with a template type-parameter T, the\n  declaration<br>\n  friend class T;<br>\n  is ill-formed. -end note]</br></br></p>\n</blockquote>\n<p>On a related note, this restriction seems to be removed in C++0x\n(\u00a711.3/3 in N3290).<br>\nIncidentally, <code>MSVC</code> may allow this if we write simply <code>friend T;</code>.</br></p>\n", "OwnerUserId": "547710", "PostTypeId": "2", "Id": "6321326", "Score": "12", "CreationDate": "2011-06-12T09:55:01.617", "LastActivityDate": "2011-06-12T09:55:01.617"}, "6321191": {"CommentCount": "0", "ViewCount": "1668", "LastActivityDate": "2011-06-12T10:10:12.917", "Body": "<p>I am writing a small class, the class is basically a factory for the C class, but I want other classes to be able to access some of the methods. </p>\n<pre><code>template&lt;class C&gt;\nclass CFactory {\npublic:   \n   friend class C;\n};\n</code></pre>\n<p>This should make the fields of CFactory available to the class C, but the compiler thinks otherwise. </p>\n<p>I'm getting the following two errors using gcc on a mac.</p>\n<blockquote>\n<p id=\"so_6321191_6321191_0\">error: using template type parameter 'C' after 'class'</p>\n<p id=\"so_6321191_6321191_1\">error: friend declaration does not name a class or function</p>\n</blockquote>\n<p>Can anyone tell me what I'm doing wrong and how to get et right?</p>\n", "PostTypeId": "1", "AcceptedAnswerId": "6321394", "FavoriteCount": "2", "Title": "Using friend in templates", "Id": "6321191", "Score": "12", "CreationDate": "2011-06-12T09:21:47.690", "Tags": "<c++><templates><gcc>", "OwnerUserId": "750186", "AnswerCount": "3"}, "bq_ids": {"n4140": {"so_6321191_6321326_0": {"section_id": 5443, "quality": 0.5833333333333334, "length": 7}, "so_6321191_6321191_1": {"section_id": 5485, "quality": 0.8571428571428571, "length": 6}, "so_6321191_6321191_0": {"section_id": 300, "quality": 0.7142857142857143, "length": 5}}, "n3337": {"so_6321191_6321326_0": {"section_id": 5238, "quality": 0.5833333333333334, "length": 7}, "so_6321191_6321191_1": {"section_id": 120, "quality": 0.7142857142857143, "length": 5}, "so_6321191_6321191_0": {"section_id": 291, "quality": 0.7142857142857143, "length": 5}}, "n4659": {"so_6321191_6321191_1": {"section_id": 6920, "quality": 0.8571428571428571, "length": 6}, "so_6321191_6321326_0": {"section_id": 6870, "quality": 0.5833333333333334, "length": 7}, "so_6321191_6321191_0": {"section_id": 307, "quality": 0.7142857142857143, "length": 5}}}, "6321201": {"ParentId": "6321191", "CommentCount": "9", "Body": "<p><code>C</code> can be anything - <code>int</code>, <code>double</code>, etc. and they are not classes. In general, this <code>class C</code> is not <code>class</code>. And you cannot have something like:</p>\n<pre><code>class A\n{\n    friend class int;\n    //..\n};\n</code></pre>\n<p>One more reason to prefer <code>typename</code>, instead of <code>class</code> when using <code>template</code>s</p>\n", "OwnerUserId": "435800", "PostTypeId": "2", "Id": "6321201", "Score": "3", "CreationDate": "2011-06-12T09:25:13.280", "LastActivityDate": "2011-06-12T09:25:13.280"}});