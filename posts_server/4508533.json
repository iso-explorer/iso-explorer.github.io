post_cb({"4508769": {"CommentCount": "5", "Body": "<p>The base class destructor is indeed called. Sample code:</p>\n<pre><code>#include \n#include \n\nclass Base {\npublic:\n  Base() { /* ... */ }\n  ~Base() {\n    printf(\"Base\\n\");\n  }\n};\n\nclass Derived : public Base {\npublic:\n  Derived() { /* ... */ }\n  ~Derived() {\n    printf(\"Derived\\n\");\n    throw 1;\n  }\n};\n\nint main() {\n  try {\n    Derived d;\n  } catch(...) {\n    printf(\"CAUGHT!\\n\");\n  }\n}\n</code></pre>\n<p>This prints:</p>\n<pre><code>Derived\nBase\nCAUGHT!\n</code></pre>\n", "CreationDate": "2010-12-22T11:37:38.530", "ParentId": "4508533", "Id": "4508769", "LastActivityDate": "2010-12-22T11:37:38.530", "PostTypeId": "2", "Score": "1", "OwnerUserId": "358904"}, "4508533": {"CreationDate": "2010-12-22T11:08:41.280", "ViewCount": "1941", "FavoriteCount": "7", "Id": "4508533", "AcceptedAnswerId": "4508687", "Score": "22", "Title": "What happens to base class destructor if a derived class destructor throws an exception", "CommentCount": "2", "Body": "<p>It just happened to me I wondered how resources are freed in the following case.</p>\n<pre><code>class Base {\n  Resource *r;\n\npublic:\n  Base() { /* ... */ }\n  ~Base() {\n    delete r; \n  }\n};\n\nclass Derived : public Base {\npublic:\n  Derived() { /* ... */ }\n  ~Derived() {\n    /* Suddenly something here throws! */\n  }\n};\n\nint main() {\n  try {\n    Derived d;\n  } catch(...) {\n    /* what happened with Base::r !? */\n  }\n}\n</code></pre>\n<p>Will the base class destructor be called if the derived class destructor throws? Or will there be a leak?</p>\n", "Tags": "<c++><exception><destructor><memory-leaks>", "LastActivityDate": "2010-12-22T11:57:27.367", "PostTypeId": "1", "AnswerCount": "3", "OwnerUserId": "34509"}, "4508583": {"LastActivityDate": "2010-12-22T11:57:27.367", "CommentCount": "6", "Body": "<p>The base destructor will get called.  </p>\n<p>In Effective C++, Meyers recommends that exceptions shouldn't leave destructors.\nCatch the exception inside the destructor and handle it, swallow it or terminate.</p>\n", "CreationDate": "2010-12-22T11:13:58.787", "LastEditDate": "2010-12-22T11:57:27.367", "ParentId": "4508533", "Id": "4508583", "LastEditorUserId": "455272", "PostTypeId": "2", "Score": "1", "OwnerUserId": "455272"}, "4508687": {"LastActivityDate": "2010-12-22T11:29:45.940", "CommentCount": "10", "Body": "<p>According to \u00a715.2/2:</p>\n<blockquote>\n<p id=\"so_4508533_4508687_0\">An object that is partially constructed or partially destroyed will have destructors executed for all of its fully constructed subobjects, that is, for subobjects for which the constructor has completed execution and the destructor has not yet begun execution.</p>\n</blockquote>\n<p>So the base class destructor should be called. That is, just like we know this will clean up the base class:</p>\n<pre><code>#include &lt;iostream&gt;\n\nstruct foo\n{\n    ~foo()\n    {\n        std::cout &lt;&lt; \"clean\" &lt;&lt; std::endl;\n    }\n};\n\nstruct bar : foo\n{\n    bar()\n    { // foo is initialized...\n        throw 0; // ...so its destructor is run\n    }\n};\n\nint main()\n{\n    try\n    {\n        bar b;\n    }\n    catch (...)\n    {\n        std::cerr &lt;&lt; \"caught\" &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n<p>And that this will clean up the member:</p>\n<pre><code>#include &lt;iostream&gt;\n\nstruct foo\n{\n    ~foo()\n    {\n        std::cout &lt;&lt; \"clean\" &lt;&lt; std::endl;\n    }\n};\n\nstruct bar\n{\n    ~bar()\n    { // f has been initialized...\n        throw 0; // ...so its destructor will run\n    }\n\n    foo f;\n};\n\nint main()\n{\n    try\n    {\n        bar b;\n    }\n    catch (...)\n    {\n        std::cerr &lt;&lt; \"caught\" &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n<p>This will also clean up the base class:</p>\n<pre><code>#include &lt;iostream&gt;\n\nstruct foo\n{\n    ~foo()\n    {\n        std::cout &lt;&lt; \"clean\" &lt;&lt; std::endl;\n    }\n};\n\nstruct bar : foo\n{\n    ~bar()\n    { // foo has been initialized...\n        throw 0; // ...so its destructor will run\n    }\n};\n\nint main()\n{\n    try\n    {\n        bar b;\n    }\n    catch (...)\n    {\n        std::cerr &lt;&lt; \"caught\" &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n<p>That's my understanding of the quote.</p>\n", "CreationDate": "2010-12-22T11:26:40.103", "LastEditDate": "2010-12-22T11:29:45.940", "ParentId": "4508533", "Id": "4508687", "LastEditorUserId": "123111", "PostTypeId": "2", "Score": "20", "OwnerUserId": "87234"}, "bq_ids": {"n4140": {"so_4508533_4508687_0": {"length": 18, "quality": 0.8181818181818182, "section_id": 3344}}, "n3337": {"so_4508533_4508687_0": {"length": 18, "quality": 0.8181818181818182, "section_id": 3214}}}});