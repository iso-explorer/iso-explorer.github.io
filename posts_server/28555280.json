post_cb({"28555380": {"ParentId": "28555280", "PostTypeId": "2", "CommentCount": "4", "Body": "<p>[dcl.fct.def.default]/p5, emphasis mine:</p>\n<blockquote>\n<p id=\"so_28555280_28555380_0\">A function is <em>user-provided</em> if it is user-declared and not\n  explicitly defaulted or deleted on its first declaration. A\n  user-provided explicitly-defaulted function (i.e., explicitly\n  defaulted after its first declaration) is defined at the point where\n  it is explicitly defaulted; <strong>if such a function is implicitly defined\n  as deleted, the program is ill-formed</strong>.</p>\n</blockquote>\n<p>This makes sense as any use of a deleted function should render a program ill-formed, but with a user-provided explicitly-defaulted function, it may be impossible to diagnose this at the call site:</p>\n<pre><code>// y.h\nstruct X\n{\n};\n\nstruct Y\n{\n    X&amp;&amp; x; \n    Y(Y const&amp;);\n};\n\n// y.cpp\n#include \"y.h\"\nY::Y(Y const&amp;)= default; //defined as deleted\n\n// main.cpp\n#include \"y.h\"\n\nint main() {\n   Y y = Y();\n}\n</code></pre>\n<p>When compiling <code>main.cpp</code>, the compiler has no idea about <code>Y</code>'s copy constructor other than that it exists; it doesn't know that it's defaulted, and can't possibly diagnose that it is actually deleted. The only place such a error can be diagnosed is where the function is explicitly defaulted.</p>\n", "OwnerUserId": "2756719", "LastEditorUserId": "2756719", "LastEditDate": "2015-02-17T05:48:15.713", "Id": "28555380", "Score": "2", "CreationDate": "2015-02-17T05:37:01.323", "LastActivityDate": "2015-02-17T05:48:15.713"}, "bq_ids": {"n4140": {"so_28555280_28555380_0": {"section_id": 3274, "quality": 0.9655172413793104, "length": 28}, "so_28555280_28555280_0": {"section_id": 460, "quality": 0.7142857142857143, "length": 5}, "so_28555280_28555280_2": {"section_id": 460, "quality": 0.9130434782608695, "length": 21}}, "n3337": {"so_28555280_28555380_0": {"section_id": 3145, "quality": 0.9655172413793104, "length": 28}, "so_28555280_28555280_0": {"section_id": 451, "quality": 0.7142857142857143, "length": 5}, "so_28555280_28555280_2": {"section_id": 451, "quality": 0.782608695652174, "length": 18}}, "n4659": {"so_28555280_28555380_0": {"section_id": 4032, "quality": 0.9655172413793104, "length": 28}, "so_28555280_28555280_0": {"section_id": 382, "quality": 0.7142857142857143, "length": 5}, "so_28555280_28555280_2": {"section_id": 483, "quality": 0.9130434782608695, "length": 21}}}, "28555280": {"CommentCount": "0", "AcceptedAnswerId": "28555380", "OwnerDisplayName": "user2953119", "CreationDate": "2015-02-17T05:28:41.100", "LastActivityDate": "2015-02-17T05:48:15.713", "PostTypeId": "1", "ViewCount": "78", "FavoriteCount": "1", "Title": "User-provided constructor vs explicitly defaulted one", "Id": "28555280", "Score": "1", "Body": "<p><code>N4296::12.8/11 [class.copy]</code> told us the following:</p>\n<blockquote>\n<p id=\"so_28555280_28555280_0\">A defaulted copy/move constructor for a class X is defined as deleted\n  (8.4.3) if X has:</p>\n<p id=\"so_28555280_28555280_1\">[...]</p>\n<p id=\"so_28555280_28555280_2\">(11.2) \u2014 a potentially constructed subobject type M (or array thereof)\n  that cannot be copied/moved because overload resolution (13.3), as\n  applied to M\u2019s corresponding constructor, results in an ambiguity or a\n  function that is deleted or inaccessible from the defaulted\n  constructor</p>\n<p id=\"so_28555280_28555280_3\">[...]</p>\n</blockquote>\n<p>So it's not clear why the program</p>\n<pre><code>struct X\n{\n};\n\nstruct Y\n{\n    X&amp;&amp; x; \n    Y(Y const&amp;)= default;\n};\n\nint main() { }\n</code></pre>\n<p><strong><a href=\"http://coliru.stacked-crooked.com/a/ee822562dae5a533\" rel=\"nofollow\">DEMO</a></strong></p>\n<p>works fine, but the following:</p>\n<pre><code>struct X\n{\n};\n\nstruct Y\n{\n    X&amp;&amp; x; \n    Y(Y const&amp;);\n};\n\nY::Y(Y const&amp;)= default; //error\n\nint main() { }\n</code></pre>\n<p><strong><a href=\"http://coliru.stacked-crooked.com/a/33f82b828245e0ad\" rel=\"nofollow\">DEMO</a></strong></p>\n", "Tags": "<c++><class><constructor>", "AnswerCount": "1"}});