post_cb({"35177712": {"ParentId": "35177608", "CommentCount": "0", "Body": "<p>Automatic variables are removed in the reverse order to their declaration.</p>\n<p>So the return value of the function is established before the call to <code>~Foo()</code>.</p>\n<p>The return of <code>foobar</code> is therefore a very well-defined 0.</p>\n<p>Your question would be more interesting if your function returned <code>int&amp;</code>.</p>\n", "OwnerUserId": "2380830", "PostTypeId": "2", "Id": "35177712", "Score": "2", "CreationDate": "2016-02-03T12:55:48.917", "LastActivityDate": "2016-02-03T12:55:48.917"}, "35177608": {"CommentCount": "6", "AcceptedAnswerId": "35177738", "LastEditDate": "2016-02-03T13:07:20.247", "LastEditorUserId": "2069064", "CreationDate": "2016-02-03T12:51:21.790", "LastActivityDate": "2016-02-03T13:07:20.247", "PostTypeId": "1", "ViewCount": "175", "Title": "When exactly is return value copied", "Id": "35177608", "OwnerUserId": "781743", "Body": "<p>Let's suppose I have following code:</p>\n<pre><code>int bar = 0;\n\nstruct Foo {\n    ~Foo() { bar = 1; }\n};\n\nint main(int argc, char ** argv) {\n    Foo f;\n    return bar;\n}\n</code></pre>\n<p>What will be return value of program? 0 or 1?</p>\n", "Tags": "<c++><c++11><visual-c++>", "Score": "2", "AnswerCount": "2"}, "bq_ids": {"n4659": {"so_35177608_35177738_0": {"section_id": 4800, "quality": 0.875, "length": 21}}}, "35177738": {"ParentId": "35177608", "CommentCount": "1", "Body": "<p>From [stmt.return]/3:</p>\n<blockquote>\n<p id=\"so_35177608_35177738_0\">The copy-initialization of the returned entity is sequenced before the destruction of temporaries at the end of the full-expression established by the operand of the return statement, which, in turn, is sequenced before\n  the destruction of local variables (6.6) of the block enclosing the return statement.</p>\n</blockquote>\n<p>So the destructor runs after the return value has been initialized, and the return value is thus 0 on the first call of your function.</p>\n", "OwnerUserId": "596781", "PostTypeId": "2", "Id": "35177738", "Score": "12", "CreationDate": "2016-02-03T12:56:52.083", "LastActivityDate": "2016-02-03T12:56:52.083"}});