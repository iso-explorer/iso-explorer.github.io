post_cb({"14624215": {"ViewCount": "46", "Body": "<p>When passing around heap allocated arrays at some point we call:</p>\n<pre><code>delete [] ptrName\n</code></pre>\n<p>How does the compiler remember how much memory needs to be de-allocated? </p>\n<p>Context:</p>\n<p>We've got several programs that throw around pointers to byte arrays on the heap, for various reasons casting between int32, int8 and others as appropriate. When the memory needs de-allocating with a delete call what exactly goes on to make sure the right amount is freed?</p>\n<p>Thanks</p>\n", "Title": "specific query on array de-allocation on the heap", "CreationDate": "2013-01-31T11:04:59.670", "LastActivityDate": "2013-01-31T17:05:28.737", "CommentCount": "0", "PostTypeId": "1", "Id": "14624215", "Score": "0", "OwnerUserId": "2286465", "Tags": "<c++><memory-management><compiler-construction><heap>", "AnswerCount": "2"}, "bq_ids": {"n4140": {"so_14624215_14624536_0": {"length": 34, "quality": 0.9714285714285714, "section_id": 6095}}, "n3337": {"so_14624215_14624536_0": {"length": 34, "quality": 0.9714285714285714, "section_id": 5861}}, "n4659": {"so_14624215_14624536_0": {"length": 33, "quality": 0.9428571428571428, "section_id": 7592}}}, "14624536": {"Id": "14624536", "PostTypeId": "2", "Body": "<p>Compiler allocates <code>x</code> bytes of overhead which has the allocated memory information, it knows how much to delete when <code>delete []</code> is called.</p>\n<p><strong>\u00a7 5.3.4 NEW</strong></p>\n<ul>\n<li>new T[5] results in a call of operator new, and    </li>\n<li>new(2,f) T[5] results in a call of operator new.</li>\n</ul>\n<blockquote>\n<p id=\"so_14624215_14624536_0\">Here, x and y are non-negative unspecified values representing array\n  allocation overhead; the result of the new-expression will be offset\n  by this amount from the value returned by operator new[]. This\n  overhead may be applied in all array new-expressions, including those\n  referencing the library function operator new[](std::size_t, void*)\n  and other placement allocation</p>\n</blockquote>\n", "LastActivityDate": "2013-01-31T11:21:26.110", "CommentCount": "0", "CreationDate": "2013-01-31T11:21:26.110", "ParentId": "14624215", "Score": "1", "OwnerUserId": "951757"}, "14624267": {"Id": "14624267", "PostTypeId": "2", "Body": "<p>There is nothing in standard about it. Developers of compiler make decisions, where to store how much memory needs to be deallocated, by writing in some place amount of memory, that will be allocated by new.</p>\n", "LastActivityDate": "2013-01-31T11:07:48.763", "CommentCount": "0", "CreationDate": "2013-01-31T11:07:48.763", "ParentId": "14624215", "Score": "0", "OwnerUserId": "1498580"}});