post_cb({"46103102": {"CommentCount": "4", "CreationDate": "2017-09-07T18:41:00.077", "PostTypeId": "1", "AcceptedAnswerId": "46103645", "LastEditorUserId": "3980929", "LastActivityDate": "2017-09-23T15:56:44.933", "LastEditDate": "2017-09-23T15:56:44.933", "ViewCount": "180", "FavoriteCount": "2", "Title": "How to provide deduction guide for nested template class?", "Id": "46103102", "Score": "15", "Body": "<p>According to [<a href=\"https://timsong-cpp.github.io/cppwp/n4659/temp.deduct.guide#3\" rel=\"nofollow noreferrer\">temp.deduct.guide/3</a>]:</p>\n<blockquote>\n<p id=\"so_46103102_46103102_0\">(...) A deduction-guide shall be declared in the same scope as the\n  corresponding class template and, for a member class template, with\n  the same access. (...)</p>\n</blockquote>\n<p>But below example doesn't seem to compile in both <a href=\"https://wandbox.org/permlink/1rdB8ARfgFgqr8te\" rel=\"nofollow noreferrer\">[gcc]</a> and <a href=\"https://wandbox.org/permlink/8Q2p6eZLxTkU2WR1\" rel=\"nofollow noreferrer\">[clang]</a>.</p>\n<pre><code>#include &lt;string&gt;\n\ntemplate &lt;class&gt;\nstruct Foo {\n    template &lt;class T&gt;\n    struct Bar {\n        Bar(T) { }\n    };\n    Bar(char const*) -&gt; Bar&lt;std::string&gt;;\n};\n\nint main() {\n    Foo&lt;int&gt;::Bar bar(\"abc\");\n    static_cast&lt;void&gt;(bar);\n}\n</code></pre>\n<p>What is the correct syntax of deduction guide for nested template class? Or maybe this one is correct but it isn't yet supported by the compilers?</p>\n<p><hr>\nSimilar syntax but without nested class compiles fine both in gcc and clang:</hr></p>\n<pre><code>#include &lt;string&gt;\n\ntemplate &lt;class T&gt;\nstruct Bar {\n    Bar(T) { }\n};\nBar(char const*) -&gt; Bar&lt;std::string&gt;;\n\nint main() {\n    Bar bar(\"abc\");\n    static_cast&lt;void&gt;(bar);\n}\n</code></pre>\n", "Tags": "<c++><templates><c++1z><deduction-guide>", "OwnerUserId": "4324224", "AnswerCount": "1"}, "bq_ids": {"n4140": {"so_46103102_46103102_0": {"section_id": 130, "quality": 0.5833333333333334, "length": 7}, "so_46103102_46103645_0": {"section_id": 130, "quality": 0.5833333333333334, "length": 7}}, "n3337": {"so_46103102_46103102_0": {"section_id": 124, "quality": 0.5833333333333334, "length": 7}, "so_46103102_46103645_0": {"section_id": 124, "quality": 0.5833333333333334, "length": 7}}, "n4659": {"so_46103102_46103102_0": {"section_id": 372, "quality": 1.0, "length": 12}, "so_46103102_46103645_0": {"section_id": 372, "quality": 1.0, "length": 12}}}, "46103645": {"ParentId": "46103102", "CommentCount": "5", "Body": "<p><a href=\"http://eel.is/c++draft/temp.deduct.guide#3.sentence-4\" rel=\"noreferrer\">[temp.deduct.guide]</a> includes the sentence:</p>\n<blockquote>\n<p id=\"so_46103102_46103645_0\">A <em>deduction-guide</em> shall be declared in the same scope as the corresponding class template and, for a member class template, with the same access.</p>\n</blockquote>\n<p>This suggests that your example should work - deduction guides are explicitly supported for member class templates, as long as they're declared in the same scope and access (which would be the class scope and <code>public</code> - check and check).</p>\n<p>This is <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=79501\" rel=\"noreferrer\">gcc bug 79501</a> (filed by Richard Smith).</p>\n", "OwnerUserId": "2069064", "PostTypeId": "2", "Id": "46103645", "Score": "11", "CreationDate": "2017-09-07T19:17:45.113", "LastActivityDate": "2017-09-07T19:17:45.113"}});