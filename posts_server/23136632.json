post_cb({"23136632": {"CommentCount": "1", "CreationDate": "2014-04-17T14:58:53.093", "PostTypeId": "1", "AcceptedAnswerId": "23136799", "LastEditorUserId": "316448", "LastActivityDate": "2014-04-17T16:05:11.417", "LastEditDate": "2014-04-17T16:05:11.417", "ViewCount": "169", "FavoriteCount": "1", "Title": "Order of declaration matters when using decltype for member function return type", "Id": "23136632", "Score": "2", "Body": "<p>Why does this work:</p>\n<pre><code>template&lt;typename Base, typename Acc&gt;\nstruct Foo\n{\n    Base base;\n    Acc acc;\n\n    auto operator()(unsigned i) const -&gt; decltype(acc(base(i)))\n    { return acc(base(i)); }\n};\n</code></pre>\n<p>and this gives a compiler error:</p>\n<pre><code>template&lt;typename Base, typename Acc&gt;\nstruct Foo\n{\n    auto operator()(unsigned i) const -&gt; decltype(acc(base(i)))\n    { return acc(base(i)); }\n\n    Base base;\n    Acc acc;    \n};\n</code></pre>\n<blockquote>\n<p id=\"so_23136632_23136632_0\">error: there are no arguments to \u2018base\u2019 that depend on a template\n  parameter, so a declaration of \u2018base\u2019 must be available [-fpermissive]</p>\n</blockquote>\n<p>Is that really intended by the standard or a bug with GCC 4.8.1?</p>\n<hr>\n<p>I found an even shorter example for demonstration:</p>\n<pre><code>#include &lt;iostream&gt;\n\nstruct Foo\n{\n    int x;\n\n    auto getx() const -&gt; decltype(x) // OK\n    { return x; }\n\n    auto gety() const -&gt; decltype(y) // ERROR\n    { return y; }\n\n    int gety2() const // OK\n    { return y; }\n\n    int y;\n};\n\nint main(int argc, char* argv[])\n{\n    Foo f {1,2};\n    std::cout &lt;&lt; f.getx() &lt;&lt; std::endl;\n    std::cout &lt;&lt; f.gety() &lt;&lt; std::endl;\n}\n</code></pre>\n</hr>", "Tags": "<c++11><decltype>", "OwnerUserId": "316448", "AnswerCount": "1"}, "bq_ids": {"n4140": {"so_23136632_23136799_0": {"section_id": 5949, "quality": 0.7692307692307693, "length": 10}}, "n3337": {"so_23136632_23136799_0": {"section_id": 5719, "quality": 0.7692307692307693, "length": 10}}, "n4659": {"so_23136632_23136799_0": {"section_id": 7435, "quality": 0.7692307692307693, "length": 10}}}, "23136799": {"ParentId": "23136632", "PostTypeId": "2", "CommentCount": "8", "Body": "<p>It is expected to have only members declared prior to the function declaration. As seen in \u00a75.1.1 bullet 3 of the standard :</p>\n<blockquote>\n<p id=\"so_23136632_23136799_0\">If a declaration declares a member function \u2026 [ Note: <strong>only class members declared prior\n  to the declaration are visible</strong>. \u2014end note ]</p>\n</blockquote>\n", "OwnerUserId": "2694444", "LastEditorUserId": "2694444", "LastEditDate": "2014-04-17T15:53:02.107", "Id": "23136799", "Score": "2", "CreationDate": "2014-04-17T15:07:34.163", "LastActivityDate": "2014-04-17T15:53:02.107"}});