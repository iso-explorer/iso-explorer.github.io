post_cb({"47544299": {"CommentCount": "0", "ViewCount": "78", "PostTypeId": "1", "LastEditorUserId": "5376789", "CreationDate": "2017-11-29T02:56:21.203", "LastActivityDate": "2017-12-02T03:14:27.777", "Title": "Where should the definition of an explicit specialization of a class template be placed in C++?", "FavoriteCount": "1", "LastEditDate": "2017-12-02T03:14:27.777", "Id": "47544299", "Score": "7", "Body": "<p>According to <a href=\"http://www.eel.is/c++draft/temp.spec#5\" rel=\"nofollow noreferrer\">[temp.spec]/5</a>:</p>\n<blockquote>\n<p id=\"so_47544299_47544299_0\">For a given template and a given set of template-arguments,</p>\n<ul>\n<li><p id=\"so_47544299_47544299_1\">...</p></li>\n<li><p id=\"so_47544299_47544299_2\">an explicit specialization shall be defined at most once in a program (according to <a href=\"http://www.eel.is/c++draft/basic.def.odr\" rel=\"nofollow noreferrer\">[basic.def.odr]</a>), and</p></li>\n<li><p id=\"so_47544299_47544299_3\">...</p></li>\n</ul>\n</blockquote>\n<p>the definition of an explicit (full) specialization of a class template cannot be placed in a header (otherwise there is one definition in each translation unit containing this header, thus there will be more than one definition in the whole program).</p>\n<p>On the other hand, if I place the definition in a source file and leave its declaration in a header, for example,</p>\n<pre><code>// \"a.h\"\ntemplate &lt;typename T&gt;\nstruct S {};\n\ntemplate &lt;&gt;\nstruct S&lt;int&gt;; // declaration\n\n// \"a.cpp\"\n#include \"a.h\"\n\ntemplate &lt;&gt;\nstruct S&lt;int&gt; {}; // definition\n\n// \"main.cpp\"\n#include \"a.h\"\n\nint main()\n{\n    S&lt;int&gt; s;\n}\n</code></pre>\n<p>then an error occurs (<a href=\"https://wandbox.org/permlink/D4jEanBWnENeXFqs\" rel=\"nofollow noreferrer\">tested by gcc</a>) because <code>S&lt;int&gt;</code> is an incomplete type.</p>\n<p>In conclusion, where should I place the definition of an explicit specialization of a class template?</p>\n", "Tags": "<c++><templates><language-lawyer><standards><one-definition-rule>", "OwnerUserId": "5376789", "AnswerCount": "1"}, "bq_ids": {"n4140": {"so_47544299_47544299_0": {"section_id": 231, "quality": 0.8333333333333334, "length": 5}, "so_47544299_47544299_2": {"section_id": 231, "quality": 0.8571428571428571, "length": 6}}, "n3337": {"so_47544299_47544299_0": {"section_id": 224, "quality": 0.8333333333333334, "length": 5}, "so_47544299_47544299_2": {"section_id": 224, "quality": 0.8571428571428571, "length": 6}}, "n4659": {"so_47544299_47544299_0": {"section_id": 239, "quality": 0.8333333333333334, "length": 5}, "so_47544299_47544299_2": {"section_id": 239, "quality": 0.8571428571428571, "length": 6}}}, "47553880": {"ParentId": "47544299", "CommentCount": "3", "CreationDate": "2017-11-29T13:22:14.140", "OwnerUserId": "4641116", "PostTypeId": "2", "Id": "47553880", "Score": "0", "Body": "<p>This is a definition (the specialization will be instantiated), not a declaration, it probably ought to go in a specific source file (*.cpp):</p>\n<pre><code>template &lt;&gt; struct S&lt;int&gt;;\n</code></pre>\n<p>Note:  it doesn't \"hurt\" to have this in every translation unit... other than the time it takes to instantiate by the compiler, and the bloat for the object files (*.o or *.obj).</p>\n<p>This is a declaration (the specialization will not be instantiated), and is okay to put in a header file (*.h):</p>\n<pre><code>extern template &lt;&gt; struct S&lt;int&gt;;\n</code></pre>\n<p>The declaration requires C++11 or later.</p>\n", "LastActivityDate": "2017-11-29T13:22:14.140"}});