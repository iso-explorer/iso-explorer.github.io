post_cb({"25827766": {"CommentCount": "1", "ViewCount": "2274", "PostTypeId": "1", "LastEditorUserId": "420683", "CreationDate": "2014-09-13T21:13:55.710", "LastActivityDate": "2014-11-04T21:08:48.323", "Title": "C++ lambda copy value in capture-list", "AcceptedAnswerId": "25827822", "LastEditDate": "2014-09-13T21:17:38.263", "Id": "25827766", "Score": "8", "Body": "<p>I have a program as below:</p>\n<pre><code>int main()\n{\n    int val = 4;\n    auto add = [val](int a)-&gt;int{\n        val += 2;\n        return a+val;\n    };\n    cout &lt;&lt; add(3) &lt;&lt; endl;\n    cout &lt;&lt; val &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n<p>There's a compiling error in Xcode: Cannot assign to a variable captured by copy in a non-mutable lambda.</p>\n<p>My question is: if we choose to use the copy (using \"=\" or value name), can't this value be assigned a new value or changed?</p>\n", "Tags": "<c++><c++11><lambda>", "OwnerUserId": "1993552", "AnswerCount": "2"}, "25827786": {"ParentId": "25827766", "PostTypeId": "2", "CommentCount": "0", "CreationDate": "2014-09-13T21:16:40.573", "Score": "8", "LastEditorUserId": "2756719", "LastEditDate": "2014-09-13T21:23:14.950", "Id": "25827786", "OwnerUserId": "2756719", "Body": "<p>The <code>operator ()</code> of a lambda is implicitly <code>const</code> unless the lambda is declared <code>mutable</code> - and you can't modify the data members in a <code>const</code> member function. This happens regardless of the type of the capture.</p>\n", "LastActivityDate": "2014-09-13T21:23:14.950"}, "25827822": {"ParentId": "25827766", "PostTypeId": "2", "CommentCount": "0", "CreationDate": "2014-09-13T21:20:08.673", "Score": "9", "LastEditorUserId": "3647361", "LastEditDate": "2014-11-04T21:08:48.323", "Id": "25827822", "OwnerUserId": "3647361", "Body": "<p>Inside a lambda, captured variables are immutable by default. That doesn't depend on the captured variables or the way they were captured in any way. Rather, the function call operator of the closure type is declared <code>const</code>:</p>\n<blockquote>\n<p id=\"so_25827766_25827822_0\">This function call operator or operator template is declared <code>const</code>\n  (9.3.1) if and only if the lambda-expression\u2019s\n  <em>parameter-declaration-clause</em> is not followed by <code>mutable</code>.</p>\n</blockquote>\n<p>Therefore, if you want to make the captured variables modifiable inside the body, just change the lambda to</p>\n<pre><code>auto add = [val] (int a) mutable -&gt; int {\n    val += 2;\n    return a+val;\n};\n</code></pre>\n<p>so the <code>const</code>-specifier is removed.</p>\n", "LastActivityDate": "2014-11-04T21:08:48.323"}, "bq_ids": {"n4140": {"so_25827766_25827822_0": {"section_id": 5964, "quality": 0.8461538461538461, "length": 11}}, "n3337": {"so_25827766_25827822_0": {"section_id": 5733, "quality": 0.7692307692307693, "length": 10}}, "n4659": {"so_25827766_25827822_0": {"section_id": 7454, "quality": 0.8461538461538461, "length": 11}}}});