post_cb({"39632563": {"CommentCount": "2", "AcceptedAnswerId": "39632632", "PostTypeId": "1", "LastEditorUserId": "3309790", "CreationDate": "2016-09-22T07:14:54.363", "LastActivityDate": "2016-09-22T07:28:25.173", "LastEditDate": "2016-09-22T07:28:21.367", "ViewCount": "125", "FavoriteCount": "1", "Title": "What happens when delete a polymorphic object without a virtual destructor?", "Id": "39632563", "Score": "1", "Body": "<p>In following example, <code>b</code> is a polymorphic pointer type whose <strong>static</strong> type is <code>Base*</code> and whose <strong>dynamic</strong> type is <code>Derived*</code>.</p>\n<pre><code>struct Base \n{\n  virtual void f();\n};\n\nstruct Derived : Base \n{ \n\n};\n\nint main()\n{\n   Base *b = new Derived();\n   // ...\n   delete b;\n}\n</code></pre>\n<p>What happens when <code>b</code> is deleted without a virtual destructor?</p>\n", "Tags": "<c++><virtual><delete-operator><virtual-destructor>", "OwnerUserId": "5612562", "AnswerCount": "2"}, "39632632": {"ParentId": "39632563", "PostTypeId": "2", "CommentCount": "1", "CreationDate": "2016-09-22T07:18:27.217", "Score": "2", "LastEditorUserId": "3309790", "LastEditDate": "2016-09-22T07:26:28.717", "Id": "39632632", "OwnerUserId": "3309790", "Body": "<blockquote>\n<p id=\"so_39632563_39632632_0\">What happens when b is deleted without a virtual destructor?</p>\n</blockquote>\n<p>We don't know. The behavior is undefined. For most actual cases the destructor of <code>Derived</code> might no be invoked, but nothing is guaranteed.</p>\n<p><a href=\"http://eel.is/c++draft/expr.delete#3\" rel=\"nofollow\">5.3.5 Delete\n[expr.delete]</a></p>\n<p>(emphasis mine)</p>\n<blockquote>\n<p id=\"so_39632563_39632632_1\">In the first alternative (delete object), if the static type of the\n  object to be deleted is different from its dynamic type, the static\n  type shall be a base class of the dynamic type of the object to be\n  deleted and <strong>the static type shall have a virtual destructor or the\n  behavior is undefined</strong>.</p>\n</blockquote>\n", "LastActivityDate": "2016-09-22T07:26:28.717"}, "bq_ids": {"n4140": {"so_39632563_39632632_1": {"section_id": 6107, "quality": 0.9629629629629629, "length": 26}}, "n3337": {"so_39632563_39632632_0": {"section_id": 4515, "quality": 0.6666666666666666, "length": 4}, "so_39632563_39632632_1": {"section_id": 5873, "quality": 0.9629629629629629, "length": 26}}, "n4659": {"so_39632563_39632632_1": {"section_id": 7604, "quality": 0.9629629629629629, "length": 26}}}, "39632826": {"ParentId": "39632563", "CommentCount": "0", "CreationDate": "2016-09-22T07:28:25.173", "OwnerUserId": "6124277", "PostTypeId": "2", "Id": "39632826", "Score": "0", "Body": "<p>By fact it depends from target compiler and in common case</p>\n<pre><code>delete b;\n</code></pre>\n<p>is call of the descructor function for type of b and then free allocated memory.\nSo if the destructor is virtual then called function from virtual table (~Derived) but if is not then called function from the class (~Base).\nExpected result: ~Base only will be called.</p>\n", "LastActivityDate": "2016-09-22T07:28:25.173"}});