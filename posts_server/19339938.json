post_cb({"19340067": {"ParentId": "19339938", "CommentCount": "0", "Body": "<p>Why take the risk?</p>\n<p>A few bytes to ensure that the base classes get destroyed as well is not that big of a hit.</p>\n<p>Prevents memory leaks as well.</p>\n", "OwnerUserId": "892256", "PostTypeId": "2", "Id": "19340067", "Score": "0", "CreationDate": "2013-10-12T23:00:22.480", "LastActivityDate": "2013-10-12T23:00:22.480"}, "19339938": {"CommentCount": "1", "ViewCount": "103", "PostTypeId": "1", "LastEditorUserId": "2874988", "CreationDate": "2013-10-12T22:42:49.057", "LastActivityDate": "2013-10-12T23:03:08.060", "Title": "C++ Inheritance without virtual destructors", "AcceptedAnswerId": "19339992", "LastEditDate": "2013-10-12T23:03:08.060", "Id": "19339938", "Score": "2", "Body": "<p>If the parent class's destructor is not virtual, but the subclass has no additional members, is it safe to use the parent class's destructor?</p>\n<pre><code>class A{\n    ~A();\n    protected:\n        int i;\n};\nclass B: public A{\n\n}\n\nA *x = new B; delete x;\n</code></pre>\n", "Tags": "<c++><inheritance>", "OwnerUserId": "2874988", "AnswerCount": "3"}, "19339992": {"ParentId": "19339938", "LastEditDate": "2013-10-12T23:00:18.150", "CommentCount": "4", "CreationDate": "2013-10-12T22:50:42.037", "OwnerUserId": "2073257", "LastEditorUserId": "2073257", "PostTypeId": "2", "Id": "19339992", "Score": "3", "Body": "<p>It is not safe, it's undefined behaviour as per \u00a75.3.5</p>\n<blockquote>\n<h3>5.3.5 Delete [expr.delete]</h3>\n<p id=\"so_19339938_19339992_0\"><sup>3</sup> In the first alternative (delete object), if the static type of the object to be deleted is different from its dynamic type, the static type shall be a base class of the dynamic type of the object to be deleted and the static type shall have a virtual destructor or the behavior is undefined. In the second alternative (delete array) if the dynamic type of the object to be deleted differs from its static type, the behavior is undefined.</p>\n</blockquote>\n<p>An example of <em>why</em> it could break is this:</p>\n<pre><code>class A\n{\npublic:\n    ~A();\nprotected:\n    int i;\n};\n\nclass B: public A\n{\n    virtual void dummy();\n}\n\nA *x = new B; delete x;\n</code></pre>\n<p>Now <code>B</code> has a vtbl and hence the object layout is different.</p>\n<p>And BTW: <code>public class A</code> is Java or some other language, but not C++.</p>\n", "LastActivityDate": "2013-10-12T23:00:18.150"}, "bq_ids": {"n4140": {"so_19339938_19339992_0": {"section_id": 6107, "quality": 0.9512195121951219, "length": 39}}, "n3337": {"so_19339938_19339992_0": {"section_id": 5873, "quality": 0.9512195121951219, "length": 39}}, "n4659": {"so_19339938_19339992_0": {"section_id": 7604, "quality": 0.9512195121951219, "length": 39}}}, "19339947": {"ParentId": "19339938", "CommentCount": "4", "Body": "<p>the short answer is no, it is unsafe.</p>\n", "OwnerUserId": "2797544", "PostTypeId": "2", "Id": "19339947", "Score": "3", "CreationDate": "2013-10-12T22:43:55.960", "LastActivityDate": "2013-10-12T22:43:55.960"}});