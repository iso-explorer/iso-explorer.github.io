post_cb({"27020187": {"Id": "27020187", "PostTypeId": "2", "Body": "<p>Yes, this causes undefined behavior.</p>\n<p>When you bind a const reference to a temporary, the lifetime of the temporary is extended to the scope of the bound reference. In your case, this is the function <code>bar</code>. Thus, you cannot access the temporary after the <code>bar</code> function exits.</p>\n<p><strong>Edit:</strong></p>\n<p>Looked it up in the standard and actually the lifetime of the temporary is extended to the full expression containing <code>bar</code>. So it depends on how <code>BOOST_FOREACH</code> is implemented whether your code is UB or not.</p>\n<p>From N3337 12.2.5</p>\n<blockquote>\n<p id=\"so_27019340_27020187_0\">A temporary bound to a reference parameter in a\n  function call (5.2.2) persists until the completion of the full\n  expression containing the call.</p>\n</blockquote>\n", "LastEditorUserId": "1741297", "LastActivityDate": "2014-11-19T21:16:49.703", "Score": "1", "CreationDate": "2014-11-19T15:08:42.120", "ParentId": "27019340", "CommentCount": "2", "OwnerUserId": "1741297", "LastEditDate": "2014-11-19T21:16:49.703"}, "bq_ids": {"n4140": {"so_27019340_27020187_0": {"length": 12, "quality": 0.8571428571428571, "section_id": 382}}, "n3337": {"so_27019340_27020187_0": {"length": 12, "quality": 0.8571428571428571, "section_id": 373}}, "n4659": {"so_27019340_27020187_0": {"length": 11, "quality": 0.7857142857142857, "section_id": 397}}}, "27019413": {"Id": "27019413", "PostTypeId": "2", "Body": "<p>Yes. The FOREACH is happening on a reference to a struct which has been created by the foo call, and gone out of scope after being passed through to bar()</p>\n", "LastActivityDate": "2014-11-19T14:31:07.340", "CommentCount": "5", "CreationDate": "2014-11-19T14:31:07.340", "ParentId": "27019340", "Score": "1", "OwnerUserId": "62032"}, "27019340": {"ViewCount": "68", "Body": "<p>Address sanitizer is complaining.</p>\n<pre><code>struct X\n{\n  iterator begin();\n  iterator end();\n};\n\nX foo();\n\nconst X&amp; bar(const X&amp; x)\n{\n  return x;\n}\n\nBOOST_FOREACH(const auto&amp; xitem, bar(foo()))\n{\n  //use xitem\n}\n</code></pre>\n", "AcceptedAnswerId": "27019413", "Title": "Does this cause undefined behavior?", "CreationDate": "2014-11-19T14:27:02.543", "Id": "27019340", "CommentCount": "1", "PostTypeId": "1", "LastActivityDate": "2014-11-19T21:16:49.703", "Score": "-1", "OwnerUserId": "463758", "Tags": "<c++><undefined-behavior><boost-foreach>", "AnswerCount": "2"}});